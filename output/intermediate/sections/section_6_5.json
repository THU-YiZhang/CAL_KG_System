{
  "section_num": "6.5",
  "title": "宽线性范围差分输入级",
  "start_line": 4213,
  "end_line": 4552,
  "content": "### 6.5 宽线性范围差分输入级\n实际运放的信号处理精度最终由电路噪声决定, 而在噪声起主导作用前, 电路失真已成为限制精度提高的主要因素。失真包括线性失真和非线性失真两大类。线性失真不产生新的频率分量,主要是信号幅度或形状的改变,它主要由信号增益的变化引起。非线性失真产生新的频率分量,其根源在于器件的非线性工作状态。\n设电路的输出具有 $n$ 阶非线性响应特性,即 $y = \\sum {a}_{\\mathrm{i}}{x}^{i}\\left( t\\right)$ ,则在 $x\\left( t\\right)  = A\\cos \\left( {\\omega t}\\right)$ 的基波信号输入下, 包含直流、基频以及各次谐波分量的输出为\n$$\ny\\left( t\\right)  = \\frac{{a}_{2}{A}^{2}}{2} + \\left( {{a}_{1}A + \\frac{3{a}_{3}{A}^{3}}{4}}\\right) \\cos {\\omega t} + \\frac{{a}_{2}{A}^{2}}{2}\\cos {2\\omega t} + \\frac{3{a}_{3}{A}^{3}}{4}\\cos {3\\omega t} + \\cdots  \\tag{6-18}\n$$\n式中,直流输出对应系统的静态工作点失调,各次谐波能量相对基波信号能量的比例主要由非线性失真系数 ${a}_{\\mathrm{i}}\\left( {i > 1}\\right)$ 决定。在全差分对称结构中,直流失调和各偶次项失真被有效抑制,电路失真主要由 3 次以上的奇次谐波分量决定。通常,谐波次数越高,能量越小,总的谐波失真 THD(Total Harmours Distortion)定义为各次谐波失真的总和。在 THD $<$ 0.1% 的要求下,电路增益至少应大于 ${60}\\mathrm{\\;{dB}}$ 。如仅考虑 3 次以内的谐波失真,则 THD 近似为\n$$\n\\mathrm{{THD}} = \\frac{\\sqrt{{\\left( {a}_{2}{A}^{2}/2\\right) }^{2} + {\\left( 3{a}_{3}{A}_{3}/4\\right) }^{2}}}{\\sqrt{{\\left( {a}_{1}A + 3{a}_{3}{A}^{3}/4\\right) }^{2}}} \\tag{6-19}\n$$\n基本差分对性能上的局限性主要表现在线性范围与共模范围窄 (达不到轨至轨)、压摆率小、增益低。根据差分输入级对称结构抑制偶次谐波失真的特性,电路中仅残留奇次谐波分量,偶次谐波分量被有效抑制。与最大线性失真度 $\\mathrm{{NL}}$ 相关的线性范围,可通过以下误差的相对变化率求解得到, 即\n$$\n\\left. \\begin{array}{l} \\frac{k}{2 \\times  4{I}_{\\mathrm{{SS}}}}{V}_{\\mathrm{{id}}}^{2} \\leq  {NL} \\\\  {V}_{\\mathrm{{id}}} \\leq  \\sqrt{4\\mathrm{{NL}}}\\sqrt{2\\frac{{I}_{\\mathrm{{SS}}}}{{k}_{\\mathrm{n}}}} = \\sqrt{4\\mathrm{{NL}}}{\\Delta }_{\\max } \\end{array}\\right\\}   \\tag{6-20}\n$$\n差分对中的任一单管流过的最大电流为 ${I}_{\\mathrm{{SS}}}$ ,则 ${\\Delta }_{\\max }$ 为差分对中单个放大管在最大驱动电流下的最大过驱动电压,而与此管相对应的放大管截止,其过驱动电压为零,因此 ${\\Delta }_{\\max }$ 实际代表了差分输入 ${V}_{\\mathrm{{id}}}$ 的最大动态范围。上式表明,在特定非线性误差 $\\mathrm{{NL}}$ 的限定条件下, 动态范围 ${\\Delta }_{\\max }$ 增加,线性范围自然相应增加。同时,放宽非线性误差 $\\mathrm{{NL}}$ 的容限,线性范围也自然提高。以 $\\mathrm{{NL}} = 1\\%$ 非线性失真为例,输入信号的线性范围大致占整个动态范围的 20%。\n线性范围的扩展存在以下几种基本方式:① 由 ${V}_{\\mathrm{{id}},\\max } = \\Delta {V}_{o}/{A}_{\\mathrm{{Vd}}} < {V}_{\\mathrm{{CC}}}/{A}_{\\mathrm{{Vd}}}$ 的关系, 最大输入动态范围与开环电压增益成反比,则线性范围也应与电压增益成反比。通过负反馈控制方式降低电压增益,或者通过负反馈分担部分 ${V}_{\\mathrm{{id}}}$ 输入电压,可换取动态范围增加以及线性范围的提高。② 通过提高尾电流 ${I}_{\\mathrm{{SS}}}$ 、减小差分对管 $W/L$ 的方式,增加动态范围,线性范围作为其中的一部分,自然提高。③ 采用补偿技术消除非线性项,或利用基本电路规律将非线性 $I - V$ 关系转换为线性关系。根据以上原理,可以设计出多样化的宽线性范围的差分电路结构。\n#### 6.5.1 增益降低技术\n降低增益的最有效方法是采用闭环负反馈控制系统,将高增益的开环运放 ${A}_{\\mathrm{v}}$ 通过反馈系数为 $F$ 的反馈网络构成闭环控制。理想反馈网络的闭环增益为 ${A}_{\\mathrm{v}}/\\left( {1 + F{A}_{\\mathrm{v}}}\\right)  \\approx  1/F$ 。 对于 ${\\alpha }_{0}x + {\\alpha }_{1}{x}^{2}$ 的非线性响应系统,反馈将使二次谐波失真为\n$$\n\\frac{1}{{\\left( 1 + F{\\alpha }_{1}\\right) }^{2}} = \\frac{1}{{\\left( 1 + F{A}_{\\mathrm{v}}\\right) }^{2}} \\tag{6-21}\n$$\n因有限开环增益而引入的闭环控制误差信号为\n$$\n\\varepsilon  = \\frac{{A}_{\\mathrm{v}}}{1 + F{A}_{\\mathrm{v}}} - \\frac{1}{F} = \\frac{-1}{F\\left( {1 + F{A}_{\\mathrm{v}}}\\right) } \\approx   - \\frac{1}{F} \\times  \\frac{1}{F{A}_{\\mathrm{v}}} \\tag{6 - 22}\n$$\n闭环系统的非线性失真及误差小于最大的环路增益精度误差。除了采用全局的闭环负反馈外,采用局部负反馈以降低开环运放的增益,同样可以达到提高线性度、抑制非线性失真的目的。采用MOS二极管负载,电路增益 ${A}_{\\mathrm{v}} =  - {g}_{\\mathrm{m}}/{g}_{\\mathrm{{mL}}}$ 降低到可控范围,其值仅由放大管负载恒流管的 $W/L$ 之比决定。此外,增加尾电流管的 ${R}_{\\mathrm{S}}$ 电阻也能实现增益降低,当 ${g}_{\\mathrm{m}}{R}_{\\mathrm{S}} \\gg  1$ 时, ${G}_{\\mathrm{m}} \\approx  1/{R}_{\\mathrm{S}}$ ,增益 ${A}_{\\mathrm{v}} =  - {R}_{\\mathrm{L}}/{R}_{\\mathrm{S}}$ ,显然增加 ${R}_{\\mathrm{S}}$ 可显著降低等效跨导和输出增益,若 ${R}_{\\mathrm{S}}$ 与 ${R}_{\\mathrm{L}}$ 均采用恒流负载,则由电阻比决定的增益同样可降低到可控范围内。\n降低开环增益成为改善线性范围最直接有效的方法。图 6-20(a) 所示的差分电路, 通过在差分对管的源极引入差模信号负反馈电阻 $R$ ,实现差模增益的降低。该结构中的反馈电阻在实现线性范围增加的同时,同样对共模信号产生作用,导致输出信号的动态范围降低。进一步的改进措施如图 6-20(b) 所示,将原来独立的尾电流管分裂为两个并联的尾电流源,并分别接在差模反馈电阻 $R$ 的两端。显然,在共模输入下,电阻 $R$ 两端的电位相同, 没有共模电流流过电阻 $R$ ,即 $R$ 电阻仅流过差模信号,保持对差模信号的反馈作用。由于电阻 $R$ 不受共模信号的影响,避免了输出电压动态范围的损失。同时,由于电阻 $R$ 中存在差模电流,则电阻 $R$ 的中点位置不随差分信号而改变,等效为交流 (差模) 接地,即 $R$ 的差模负反馈控制依然成立,而总的尾电流保持不变。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_163_363_1573_819_473_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_163_363_1573_819_473_0.jpg)\n图 6-20 局部源电阻差模负反馈电路\n采用源电阻 $R$ 的串联差模负反馈、共模短路的控制方法,仅是众多采用负反馈控制方式中的一种类型。针对差分对结构和尾电流控制的改进, 将逐步演化出众多的高线性低失真的差分输入结构。\n#### 6.5.2 辅助源耦对负反馈结构\n采用附加或辅助的源耦合对分担一部分差分电压,可使总差分信号 ${V}_{\\mathrm{{id}}}$ 的范围扩大。图 $6 - {21}$ (a) 给出了一种非对称的 ${V}_{\\mathrm{{id}}}$ 分担结构, ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{2}$ 为 $W/L$ 相同的主差分对,增益因子为 ${k}_{1}$ ,承担 ${V}_{\\mathrm{{id}}}$ 中的 ${V}_{1}$ 分量,流过的差分电流分别为 $I + i$ 和 $I - i;{\\mathrm{M}}_{3}/{\\mathrm{M}}_{4}$ 为辅助差分对,其 $W/L$ 与 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{2}$ 一致,对应的增益因子为 ${k}_{2}$ ,承担 ${V}_{\\mathrm{{id}}}$ 中的 ${V}_{2}$ ,流过的差分电流分别为 $n(I +$ $i)$ 和 $n\\left( {I - i}\\right)$ 。 根据电路结构和静态偏置条件,有\n$$\n{V}_{1} = {V}_{\\mathrm{{TN}}} + \\sqrt{\\frac{2\\left( {I + i}\\right) }{{k}_{1}}} - \\left( {{V}_{\\mathrm{{TN}}} + \\sqrt{\\frac{2\\left( {I - i}\\right) }{{k}_{1}}}}\\right)  = \\sqrt{\\frac{2\\left( {I + i}\\right) }{{k}_{1}}}\\left( {1 - \\sqrt{\\frac{I - i}{I + i}}}\\right)\n$$\n(6-23)\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_164_239_743_1098_444_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_164_239_743_1098_444_0.jpg)\n图 6-21 采用辅助源耦对负反馈实现的一种 ${V}_{\\mathrm{{td}}}$ 分担结构\n类似地\n$$\n{V}_{2} = \\sqrt{\\frac{{2n}\\left( {I + i}\\right) }{{k}_{2}}}\\left( {1 - \\sqrt{\\frac{I - i}{I + i}}}\\right)  \\tag{6 - 24}\n$$\n由 ${V}_{\\mathrm{{id}}} = {V}_{1} + {V}_{2}$ ,计算得到 ${V}_{1}$ 占总差分输入 ${V}_{\\mathrm{{id}}}$ 的比重为\n$$\n\\frac{{V}_{1}}{{V}_{\\mathrm{{id}}}} = \\frac{{V}_{1}}{{V}_{1} + {V}_{2}} = \\frac{1}{1 + {V}_{2}/{V}_{1}} = \\frac{1}{1 + \\sqrt{n{k}_{1}/{k}_{2}}} = \\frac{1}{1 + A} \\tag{6 - 25}\n$$\n通过提高 ${\\mathrm{M}}_{5}/{\\mathrm{M}}_{6}$ 负载静态电流比例因子 $n$ 以及 ${k}_{1}/{k}_{2}$ 比例因子的方式,扩展常数 $A$ , 有利于扩展等效输入差分信号 ${V}_{\\mathrm{{id}}}$ 的动态范围,实现线性范围的提高。该结构由于为单端输出,输出电流的变化量减半,即 ${I}_{\\mathrm{o}} = i$ ,由以上 3 式解出\n$$\n{I}_{\\mathrm{o}} = i = \\frac{1}{2}\\sqrt{2{k}_{1}{2I}}{V}_{1}\\sqrt{1 - \\frac{{k}_{1}{V}_{1}^{2}}{2\\left( {2I}\\right) }} = \\sqrt{{k}_{1}I}\\frac{{V}_{\\mathrm{{id}}}}{1 + A}\\sqrt{1 - \\frac{{k}_{1}{V}_{\\mathrm{{id}}}^{2}}{{4I}{\\left( 1 + A\\right) }^{2}}} \\tag{6-26}\n$$\n当 $A = 0$ ,即取消辅助源耦对后,可还原为普通差分对,式(6-26)还原为与基本差分对类似的交流小信号输出电流, 但电流值减半。\n为充分利用差分输入信号,获得最大的差分输出电流,图 6-21(b) 给出了采用 ${\\mathrm{M}}_{3} \\sim  {\\mathrm{M}}_{6}$ 两对相同 PMOS 辅助源耦对的 ${V}_{\\mathrm{{id}}}$ 电压分担方式, ${\\mathrm{M}}_{1} \\sim  {\\mathrm{M}}_{2}$ 构成 NMOS 主差分对,其增益因子为 ${k}_{1}$ ,差分电压 ${V}_{\\mathrm{{id}}}$ 。辅助单元的静态偏置电流均与主差分对相同,在相同的 $W/L$ 下,各单元增益因子相同 ${k}_{2} = {k}_{3} = {k}_{1}$ ,承担的差分电压也相同 ${V}_{2} = {V}_{3} = {V}_{1}$ 。则有\n$$\n\\frac{{V}_{1}}{{V}_{\\mathrm{{id}}}} = \\frac{{V}_{1}}{{V}_{1} + {V}_{2} + {V}_{3}} = \\frac{1}{1 + 2\\left( {{V}_{2}/{V}_{1}}\\right) } = \\frac{1}{1 + m} \\tag{6-27}\n$$\n式中 $m$ 为电路中对称辅助源耦合对的个数,有效差分电压为总差分电压的 $1/\\left( {1 + m}\\right)$ ,非线性失真减小到原有的 $1/{\\left( 1 + m\\right) }^{2}$ 。\n#### 6.5.3 自适应补偿\n在基本差分对中,尾电流 ${I}_{\\mathrm{{SS}}}$ 固定,并与 ${V}_{\\mathrm{{id}}}$ 多半呈现非线性关系。将基本差分对结构中的差分电流重写为 ${I}_{\\mathrm{o}} = {V}_{\\mathrm{{id}}}{\\left\\lbrack  k\\left( {I}_{\\mathrm{{SS}}} - k{V}_{\\mathrm{{id}}}{}^{2}/4\\right) \\right\\rbrack  }^{1/2}$ 。在自适应补偿策略中,尾电流 ${I}_{\\mathrm{{SS}}}$ 不再是常数,而是随 ${V}_{\\mathrm{{id}}}$ 变化。若 ${I}_{\\mathrm{{SS}}} = {I}_{\\mathrm{{DC}}} + {k}^{\\prime }{V}_{\\mathrm{{id}}}{}^{2}$ ,将此 ${I}_{\\mathrm{{SS}}}$ 关系代入上式中,并根据 ${V}_{\\mathrm{{id}}}$ 的变化范围,应有\n$$\n{I}_{\\mathrm{o}} = {I}_{\\mathrm{D}1} - {I}_{\\mathrm{D}2} = \\left\\{  \\begin{array}{ll} \\sqrt{k}{V}_{\\mathrm{{id}}}\\sqrt{{I}_{\\mathrm{{DC}}} + \\left( {{k}^{\\prime } - k/4}\\right) {V}_{\\mathrm{{id}}}^{2}} & \\left| {V}_{\\mathrm{{id}}}\\right|  < {V}_{\\mathrm{{id}},\\max } \\\\  {I}_{\\mathrm{{DC}}} + {k}^{\\prime }{V}_{\\mathrm{{id}}}^{2} & \\left| {V}_{\\mathrm{{id}}}\\right|  \\geq  {V}_{\\mathrm{{id}},\\max } \\end{array}\\right.  \\tag{6-28}\n$$\n式中, ${V}_{\\mathrm{{id}},\\max }$ 为差分对输入差模电压的最大值,超出此范围后,一个 MOS 管将截止。而在输入信号的动态范围内,若取 ${k}^{\\prime } = k/4$ ,则在理想匹配的条件下,动态范围内输出电流的非线性将被完全抑制,输出差分电流与输入差分电压呈线性关系,即 ${I}_{\\mathrm{o}} = {\\left( k{I}_{\\mathrm{{DC}}}\\right) }^{1/2}{V}_{\\mathrm{{id}}}$ 。\n显然,线性范围内的最大电流对应于 ${V}_{\\mathrm{{id}},\\max }$ 条件,即 ${I}_{\\mathrm{D}1} = 0$ 或 ${I}_{\\mathrm{D}2} = 0$ ,而非截止 $\\mathrm{{MOS}}$ 管中流过全部的尾电流, 则\n$$\n\\sqrt{k{I}_{\\mathrm{{DC}}}}{V}_{\\mathrm{{id}},\\max } = {I}_{\\mathrm{{DC}}} + \\frac{k}{4}{V}_{\\mathrm{{id}},\\max }^{2} \\tag{6-29}\n$$\n由此解出 ${V}_{\\mathrm{{id}},\\max } = {\\left( 4{I}_{\\mathrm{{DC}}}/k\\right) }^{1/2}$ 。根据以上原理,图 6-22 给出了一种六管自适应的尾电流动态补偿结构,所有 MOS 管均相互匹配, ${V}_{\\mathrm{{SH}}}$ 为固定的电平移位。经过 ${V}_{\\mathrm{{SH}}}$ 的电平移位后,维持 ${\\mathrm{M}}_{5}/{\\mathrm{M}}_{6}$ 管在输入信号的动态范围内始终保持饱和恒流并最终可进入截止状态。因此, 尾电流并不固定,而是与 ${V}_{\\mathrm{{id}}}$ 密切相关,满足基本约束条件。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_165_927_1545_470_416_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_165_927_1545_470_416_0.jpg)\n图 6-22 六管自适应补偿结构\n图 6-22 中,在各 MOS 管 $W/L$ 匹配且单支路内电流连续的条件下,同时忽略衬底偏置效应的影响,应有 ${V}_{\\mathrm{{GS}}1} = {V}_{\\mathrm{{GS}}3},{V}_{\\mathrm{{GS}}2} = {V}_{\\mathrm{{GS}}4}$ 。经过以上 ${V}_{\\mathrm{{GS}}}$ 的变量代换,得到 ${V}_{\\mathrm{{id}}} = {V}_{\\mathrm{{GS}}3} - {V}_{\\mathrm{{GS}}4} = {V}_{\\mathrm{S}4} - {V}_{\\mathrm{S}3}$ 。经过电平移位,有 ${V}_{\\mathrm{G}5}$ $= {V}_{\\mathrm{S}3} - {V}_{\\mathrm{S}\\mathrm{H}},{V}_{\\mathrm{G}6} = {V}_{\\mathrm{S}4} - {V}_{\\mathrm{S}\\mathrm{H}}$ 。代入 ${V}_{\\mathrm{{id}}}$ 关系后,得到 ${V}_{\\mathrm{{id}}} = {V}_{\\mathrm{G}6} - {V}_{\\mathrm{G}5} = {V}_{\\mathrm{G}{56}} - {V}_{\\mathrm{G}{55}}$ 。设 ${M}_{5}$ 、 ${\\mathrm{M}}_{6}$ 两管的共模信号为 ${V}_{\\mathrm{{CM}}}$ ,则 ${V}_{\\mathrm{{GS}}6} = {V}_{\\mathrm{{CM}}} + {0.5}{V}_{\\mathrm{{id}}},{V}_{\\mathrm{{GS}}5} = {V}_{\\mathrm{{CM}}} - {0.5}{V}_{\\mathrm{{id}}}$ ,由此得到符合动态补偿要求的 ${I}_{\\mathrm{{SS}}}$ 为\n$$\n{I}_{\\mathrm{{SS}}} = {I}_{\\mathrm{{DS5}}} + {I}_{\\mathrm{{DS6}}} = \\frac{1}{2}k{\\left( {V}_{\\mathrm{{CM}}} - \\frac{1}{2}{V}_{\\mathrm{{id}}} - {V}_{\\mathrm{{TN}}}\\right) }^{2} + \\frac{1}{2}k{\\left( {V}_{\\mathrm{{CM}}} + \\frac{1}{2}{V}_{\\mathrm{{id}}} - {V}_{\\mathrm{{TN}}}\\right) }^{2}\n$$\n( 6 -30 )\n化简后得\n$$\n{I}_{\\mathrm{{SS}}} = 2 \\times  \\frac{1}{2}k{\\left( {V}_{\\mathrm{{CM}}} - {V}_{\\mathrm{{TN}}}\\right) }^{2} + \\frac{1}{4}k{V}_{\\mathrm{{id}}}^{2} = {I}_{\\mathrm{{DC}}} + {k}^{\\prime }{V}_{\\mathrm{{id}}}^{2} \\tag{6-31}\n$$\n在静态平衡条件下, ${\\mathrm{M}}_{5}$ 、 ${\\mathrm{M}}_{6}$ 两管电流相同并分别与各差分支路中的电流相等,则 ${V}_{\\mathrm{{GS}}6}$ $= {V}_{\\mathrm{{GS}}3}$ ,式中共模信号电平 ${V}_{\\mathrm{{CM}}} = \\left( {{V}_{\\mathrm{{GS}}6} + {V}_{\\mathrm{{GS}}5}}\\right) /2$ $= \\left( {{V}_{\\mathrm{{GS}}3} + {V}_{\\mathrm{{GS}}5}}\\right) /2 = \\left( {{V}_{\\mathrm{B}} - {V}_{\\mathrm{{SH}}}}\\right) /2$ 。为保证静态尾电流 ${I}_{\\mathrm{{DC}}}$ ,至少应满足 ${V}_{\\mathrm{B}} - {V}_{\\mathrm{{SH}}} > 2{V}_{\\mathrm{{TN}}}$ 的基本要求, 从图中也可直观看出该限制条件的物理意义, 即 ${V}_{\\mathrm{B}} - {V}_{\\mathrm{{SH}}}$ 电压至少应使 ${\\mathrm{M}}_{3}/{\\mathrm{M}}_{5}$ 或 ${\\mathrm{M}}_{4}/{\\mathrm{M}}_{6}$ 两个 MOS 管饱和导通。这种六管结构的动态尾电流控制技术满足 ${k}^{\\prime } = k/4$ 的电流输出要求,线性范围扩展到与动态范围相同的区域。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_166_896_724_512_456_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_166_896_724_512_456_0.jpg)\n图 6-23 尾电流交叉耦合调制法\n图 6-23 给出了抑制非线性失真的另一种电路实现方式, 即采用交叉耦合对管 (Cross pair) 消除存在的非线性项。与普通差分对独立尾电流偏置不同的是, 将尾电流偏置分裂成相同电流的两路结构, 同时将一个 ${V}_{\\mathrm{{TH}}} + \\Delta$ 的直流电平移位电压插入到一端输入与另一端源极之间,即\n$$\n\\left. \\begin{array}{l} {V}_{\\mathrm{i}1} = {V}_{\\mathrm{{GS}}1} - \\left( {\\Delta  + {V}_{\\mathrm{{TH}}}}\\right)  + {V}_{\\mathrm{i}2} \\\\  {V}_{\\mathrm{i}2} = {V}_{\\mathrm{{GS}}2} - \\left( {\\Delta  + {V}_{\\mathrm{{TH}}}}\\right)  + {V}_{\\mathrm{i}1} \\end{array}\\right\\}   \\tag{6-32}\n$$\n设 ${V}_{\\mathrm{i}\\mathrm{d}} = {V}_{\\mathrm{i}1} - {V}_{\\mathrm{i}2}$ ,则差分对管中的电流分别为\n$$\n\\left. \\begin{array}{l} {I}_{\\mathrm{{Dl}}} = \\frac{k}{2}{\\left( {V}_{\\mathrm{{GSl}}} - {V}_{\\mathrm{{TH}}}\\right) }^{2} = \\frac{k}{2}{\\left( \\Delta  + {V}_{\\mathrm{{id}}}\\right) }^{2} \\\\  {I}_{\\mathrm{D}2} = \\frac{k}{2}{\\left( {V}_{\\mathrm{{GS}}2} - {V}_{\\mathrm{{TH}}}\\right) }^{2} = \\frac{k}{2}{\\left( \\Delta  - {V}_{\\mathrm{{id}}}\\right) }^{2} \\end{array}\\right\\}   \\tag{6-33}\n$$\n当以上两式中移位电平的过驱动电压 $\\Delta$ 为相同的常数时,则差分输出电流为 ${I}_{\\mathrm{o}} =$ ${I}_{\\mathrm{D}1} - {I}_{\\mathrm{D}2} = \\left( {2k\\Delta }\\right) {V}_{\\mathrm{{id}}}$ 。因此,普通差分对输出电流中的非线性 ${V}_{\\mathrm{{id}}}$ 项被完全抵消,同样得到与动态范围一致的线性范围。该原理电路结构实现的关键在于直流电压移位电平为固定常数,并不受 ${V}_{\\mathrm{{id}}}$ 影响。实际电路中,由于受 ${V}_{\\mathrm{{id}}}$ 影响,移位支路中的 $\\Delta$ 并不严格相同,电路参数设计应将这种失配的影响降到最低。\n根据以上非线性补偿原理及电路设计要求,图 6-24(a) 给出了基于交叉耦合差分对电平移位结构的具体实现方式,即 $W/L$ 相互匹配的 ${\\mathrm{M}}_{3}$ 和 ${\\mathrm{M}}_{4}$ 管,分别与 ${\\mathrm{M}}_{2}$ 和 ${\\mathrm{M}}_{1}$ 组成源极耦合的差分对,图中 $K = W/L$ 。为降低 ${\\mathrm{M}}_{3}\\text{、}{\\mathrm{M}}_{4}$ 管过驱动电压 $\\Delta$ 受差分 ${V}_{\\mathrm{{id}}}$ 的调制作用,应提高其静态电流偏置并降低电流的变化。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_167_170_315_1200_464_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_167_170_315_1200_464_0.jpg)\n图 6-24 基于差分对交叉耦合的非线性抵消结构\n设 ${\\mathrm{M}}_{4}$ 的 $W/L$ 比 ${\\mathrm{M}}_{1}$ 大 $n$ 倍,则静态时的尾电流为 ${nI}$ ,其差分电流的变化量为 ${i}_{1}$ ; 同样, ${\\mathrm{M}}_{2}$ 与 ${\\mathrm{M}}_{3}$ 组成的非匹配差分对,静态偏置与 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{4}$ 完全相同,其差分电流的变化量为 ${i}_{2}$ 。因此,电平移位管 ${\\mathrm{M}}_{3}$ 和 ${\\mathrm{M}}_{4}$ 中流过的电流分别为 ${nI} + {i}_{2}$ 和 ${nI} - {i}_{1}$ 。由于差分小信号电流 ${i}_{1}$ 和 ${i}_{2}$ 的影响,使流过两管的电流并不是固定常数,无法严格实现所要求的相同 $\\Delta$ 电压, 为此需要尽可能提高因子 $n$ 的数值。考虑差分输出电流的作用后,原来相同的 $\\Delta$ 变成两个不同的值 ${\\Delta }_{1}$ 和 ${\\Delta }_{2}$ ,则式( 6-33 )修正为 ${V}_{\\mathrm{{GS}}1} - {V}_{\\mathrm{{TH}}} = {\\Delta }_{1} + {V}_{\\mathrm{{id}}},{V}_{\\mathrm{{GS}}2} - {V}_{\\mathrm{{TH}}} = {\\Delta }_{2} - {V}_{\\mathrm{{id}}}$ 。设 $k$ 为差分对管 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{2}$ 的增益因子,则由 ${\\mathrm{M}}_{4}$ 和 ${\\mathrm{M}}_{3}$ 电流决定的过驱动电压分别为\n$$\n\\left. \\begin{array}{l} {\\Delta }_{1} = \\sqrt{2\\left( {{nI} - {i}_{1}}\\right) /\\left( {nk}\\right) } \\\\  {\\Delta }_{2} = \\sqrt{2\\left( {{nI} + {i}_{2}}\\right) /\\left( {nk}\\right) } \\end{array}\\right\\}   \\tag{6-34}\n$$\n由于电平移位电压受输入电压的调制,则 ${M}_{1}$ 和 ${M}_{2}$ 中的实际电流为\n$$\n\\left. \\begin{array}{l} {I}_{\\mathrm{{Dl}}} = I + {i}_{1} = \\frac{k}{2}{\\left( {\\Delta }_{1} + {V}_{\\mathrm{{id}}}\\right) }^{2} \\\\  {I}_{\\mathrm{D}2} = I - {i}_{2} = \\frac{k}{2}{\\left( {\\Delta }_{2} - {V}_{\\mathrm{{id}}}\\right) }^{2} \\end{array}\\right\\}   \\tag{6-35}\n$$\n由以上方程求解后得出\n$$\n\\left. \\begin{array}{l} {I}_{\\mathrm{{Dl}}} = I\\left( {1 + \\gamma {x}^{2} + \\frac{\\alpha }{2}x\\sqrt{1 - \\beta {x}^{2}}}\\right) \\\\  {I}_{\\mathrm{{D2}}} = I\\left( {1 + \\gamma {x}^{2} - \\frac{\\alpha }{2}x\\sqrt{1 - \\beta {x}^{2}}}\\right)  \\end{array}\\right\\}   \\tag{6 - 36}\n$$\n式中,参量 $x$ 为 ${V}_{\\mathrm{{id}}}$ 相对单管静态条件下过驱动电压的比值, $\\alpha$ 、 $\\beta$ 、 $\\gamma$ 为与 $n$ 有关的参变量:\n$$\nx = \\frac{{V}_{\\mathrm{{id}}}}{\\sqrt{{2I}/k}},\\alpha  = \\frac{4n}{n + 1},\\beta  = \\frac{n}{{\\left( n + 1\\right) }^{2}},\\gamma  = \\frac{n\\left( {n - 1}\\right) }{{\\left( n + 1\\right) }^{2}} \\tag{6-37}\n$$\n输出差分电流为\n$$\n{I}_{\\mathrm{o}} = {i}_{1} + {i}_{2} = {I}_{\\mathrm{D}1} - {I}_{\\mathrm{D}2} = {\\alpha x}\\sqrt{1 - \\beta {x}^{2}}I = \\alpha \\sqrt{\\frac{k}{2I}}{V}_{\\mathrm{{id}}}\\sqrt{1 - \\beta \\frac{k}{2I}{V}_{\\mathrm{{id}}}^{2}}I \\tag{6-38}\n$$\n为保证输出电流为实数解, ${V}_{\\mathrm{{id}}}$ 应满足的条件为\n$$\n\\left| {{V}_{\\text{id }}\\sqrt{\\frac{k}{2I}}}\\right|  \\leq  \\sqrt{\\frac{n + 1}{n}} \\tag{6 - 39}\n$$\n当 $n = 1\\text{、}\\alpha  = 2\\text{、}\\beta  = 1/4$ 时,则完全退化为为普通差分对特性,对非线性抑制没有改进作用。只有增大 $n$ 使 $\\beta$ 近似以 $1/n$ 减小,才能有效抑制差分对中的非线性因子。很明显,线性性能的改善是以牺牲面积和功耗性能为代价。\n进一步分析发现,若通过某种方式取输出电流 ${I}_{\\mathrm{D}1}$ 与 ${I}_{\\mathrm{D}2}$ 的和而非差值,则又返回到原始自适应补偿的非线性控制结构设计, 即\n$$\n{I}_{\\mathrm{D}1} + {I}_{\\mathrm{D}2} = {2I}\\left( {1 + \\gamma \\frac{k}{2I}{V}_{\\mathrm{{id}}}^{2}}\\right)  = {2I} + {\\gamma k}{V}_{\\mathrm{{id}}}^{2} = {I}_{\\mathrm{{DC}}} + k\\frac{n\\left( {n - 1}\\right) }{{\\left( n + 1\\right) }^{2}}{V}_{\\mathrm{{id}}}^{2} \\tag{6 -40}\n$$\n若取 ${I}_{\\mathrm{{SS}}} = {I}_{\\mathrm{D}1} + {I}_{\\mathrm{D}2}$ 作为自适应差分对的尾电流,则 ${I}_{\\mathrm{{SS}}}$ 可以满足动态补偿基本要求,即\n$$\n{I}_{\\mathrm{{SS}}} = {I}_{\\mathrm{{DC}}} + k\\frac{n\\left( {n - 1}\\right) }{{\\left( n + 1\\right) }^{2}}{V}_{\\mathrm{{id}}}^{2} = {I}_{\\mathrm{{SS}}0} + {k}^{\\prime }{V}_{\\mathrm{{id}}}^{2} \\tag{6-41}\n$$\n根据动态补偿所需的 $k = 4{k}^{\\prime }$ 约束条件,即 ${4n}\\left( {n - 1}\\right)  = {\\left( n + 1\\right) }^{2}$ ,解得 $n = 1 + 2/\\sqrt{3}$ $\\approx$ 2.16。\n图 6-24(b) 给出了根据动态尾电流控制原理而设计的输入差分对结构,其中 ${\\mathrm{M}}_{1} \\sim  {\\mathrm{M}}_{4}$ 组成交叉耦合的差分对,形成如式 (6-41) 所示的动态尾电流,为将此电流传输到 ${\\mathrm{M}}_{6}/{\\mathrm{M}}_{7}$ 差分对的尾电流中,引入 ${\\mathrm{M}}_{5}$ 管及两个附加的电流源 ${aI}$ ,因此有 ${aI} = {I}_{\\mathrm{{DS}}5} + {I}_{\\mathrm{{DS}}1} + {I}_{\\mathrm{{DS}}2} =$ ${I}_{\\mathrm{{DS}}5} + {I}_{\\mathrm{{DS}}6} + {I}_{\\mathrm{{DS}}7}$ ,即 ${I}_{\\mathrm{{DS}}6} + {I}_{\\mathrm{{DS}}7} = {I}_{\\mathrm{{DS}}1} + {I}_{\\mathrm{{DS}}2} = {I}_{\\mathrm{{SS}}}$ ,该式表明输入差分对 ${\\mathrm{M}}_{6}/{\\mathrm{M}}_{7}$ 中的尾电流之和 ${I}_{\\mathrm{{SS}}}$ 由 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{2}$ 交叉耦合对电流和决定,从而通过电流移位作用实现差分对尾电流的动态补偿。为保证 ${\\mathrm{M}}_{5}$ 管在 ${V}_{\\mathrm{{id}}}$ 动态范围内均处于饱和导通状态,应有 ${aI} > {I}_{\\mathrm{{SS}},\\max } = {2I} +$ ${k}^{\\prime }{V}_{\\mathrm{{id}},\\max }{}^{2}$ ,即\n$$\na > 2 + \\frac{n\\left( {n - 1}\\right) }{{\\left( n + 1\\right) }^{2}}k\\frac{2}{k}\\frac{n + 1}{n} = \\frac{2\\left( {n + 1}\\right)  + {2n}\\left( {n - 1}\\right) }{\\left( n + 1\\right) } = \\frac{4n}{n + 1} = \\beta  \\tag{6 - 42}\n$$\n代入 $n = {2.16}$ 的条件,解得 $a = {3.16} > \\beta$ 。在以上自适应补偿设计中,采用 ${V}_{\\mathrm{{id}}}$ 调制 ${I}_{\\mathrm{{SS}}}$ 电流动态偏置以消除非线性,与此相对应的, 保持尾电流不变, 可采用交叉耦合对改变复合差分对 ${I}_{\\mathrm{D}}$ 电流的等效调制方法。即通过两个并联的同型差分对将各自的非线性项相互抵消, 达到扩展线性范围的目的。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_168_1008_1610_399_337_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_168_1008_1610_399_337_0.jpg)\n图 6-25 漏交叉耦合差分对\n电路如图 6-25 所示,四管漏交叉耦合差分对中, ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{2}$ 的增益因子为 ${k}_{1}$ ,接尾电流源 ${I}_{\\mathrm{{SS}}1},{\\mathrm{M}}_{3}$ 和 ${\\mathrm{M}}_{4}$ 的增益因子为 ${k}_{2}$ ,接尾电流源 ${I}_{\\mathrm{{SS}}2}$ 。由两差分对 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{2}$ 、 ${\\mathrm{M}}_{3}/{\\mathrm{M}}_{4}$ 电流传输特性并在小信号 ${V}_{\\mathrm{{id}}}$ 的条件下得到\n$$\n\\left. \\begin{array}{l} {I}_{\\mathrm{{Dl}}} - {I}_{\\mathrm{D}2} \\approx  \\sqrt{{k}_{1}{I}_{\\mathrm{{SSI}}}}{V}_{\\mathrm{{id}}}\\left( {1 - \\frac{{k}_{1}}{8{I}_{\\mathrm{{SSI}}}}{V}_{\\mathrm{{id}}}^{2}}\\right) \\\\  {I}_{\\mathrm{D}3} - {I}_{\\mathrm{D}4} = \\sqrt{{k}_{2}{I}_{\\mathrm{{SS2}}}}{V}_{\\mathrm{{id}}}\\left( {1 - \\frac{{k}_{2}}{8{I}_{\\mathrm{{SS2}}}}{V}_{\\mathrm{{id}}}^{2}}\\right)  \\end{array}\\right\\}   \\tag{6 - 43}\n$$\n输出差分电流为 ${I}_{\\mathrm{o}} = {I}_{\\mathrm{D}1} + {I}_{\\mathrm{D}4} - \\left( {{I}_{\\mathrm{D}2} + {I}_{\\mathrm{D}3}}\\right)  = \\left( {{I}_{\\mathrm{D}1} - {I}_{\\mathrm{D}2}}\\right)  - \\left( {{I}_{\\mathrm{D}3} - {I}_{\\mathrm{D}4}}\\right)$ ,即\n$$\n{I}_{\\mathrm{o}} = {V}_{\\mathrm{{id}}}\\left( {\\sqrt{{k}_{1}{I}_{\\mathrm{{SS1}}}} - \\sqrt{{k}_{2}{I}_{\\mathrm{{SS2}}}}}\\right)  + \\frac{{V}_{\\mathrm{{id}}}^{3}}{8}\\left( {\\frac{{k}_{2}\\sqrt{{k}_{2}}}{\\sqrt{{I}_{\\mathrm{{SS2}}}}} - \\frac{{k}_{1}\\sqrt{{k}_{1}}}{\\sqrt{{I}_{\\mathrm{{SS1}}}}}}\\right)  \\tag{6-44}\n$$\n对称结构可自然抵消偶数项谐波失真,当满足 $\\left( {{I}_{\\mathrm{{SS1}}}/{I}_{\\mathrm{{SS2}}}}\\right)  = {\\left( {k}_{1}/{k}_{2}\\right) }^{3}$ 的约束条件时,奇数次谐波项被抑制,即 3 次以上的谐波失真迅速衰减并可忽略,因此输出保留线性项。为了保留线性项,两差分对并不能完全相同,即 ${I}_{\\mathrm{{SS}}1} \\neq  {I}_{\\mathrm{{SS}}2}\\text{、}{k}_{1} \\neq  {k}_{2}$ ,此结构中两个晶体管,引入了更多的输入噪声。\n#### 6.5.4 Class AB 补偿\n在自适应动态偏置的补偿结构下,跨导输出的最大电流可大于静态偏置电流。Class $\\mathrm{{AB}}$ 也具有类似的特性,因此同样可用于非线性补偿的设计。Class $\\mathrm{{AB}}$ 在消除差分对非线性的同时,还具有高频特性好、抗噪声能力强的显著特点,但共模范围损失成为 Class AB 需要解决的一个问题。在饱和状态下, 差分对中两支路电流形成的差分输出为\n$$\n{I}_{\\text{diff }} = {I}_{\\mathrm{{DS}}1} - {I}_{\\mathrm{{DS}}2} = \\frac{1}{2}k\\left( {{V}_{\\mathrm{{GS}}1} + {V}_{\\mathrm{{GS}}2} - 2{V}_{\\mathrm{{TH}}}}\\right) \\left( {{V}_{\\mathrm{{GS}}1} - {V}_{\\mathrm{{GS}}2}}\\right)  \\tag{6-45}\n$$\n如果 ${V}_{\\mathrm{{GS}}1} + {V}_{\\mathrm{{GS}}2}$ 为常数,由于 ${V}_{\\mathrm{{id}}} = {V}_{\\mathrm{{GS}}1} - {V}_{\\mathrm{{GS}}2}$ ,在此条件下差分输出电流与输入 ${V}_{\\mathrm{{id}}}$ 呈现所需的线性关系。然而,对于普通的差分对,总的 ${V}_{\\mathrm{{GS}}}$ 由于电流的变化而无法满足恒定常数的要求,这也是普通差分对产生非线性的根源。只有在 ${V}_{\\mathrm{{id}}}$ 很小的条件下,差分对中的电流才近似相同, ${V}_{\\mathrm{{GS}}}$ 之和近似为常数并表现出良好的线性特性。\nClass AB 差分对的实质,就是通过对普通差分结构的改造,实现差分对 ${V}_{\\mathrm{{GS}}}$ 电压之和为常数的要求,同时保持 ${V}_{\\mathrm{{GS}}}$ 电压之差 ${V}_{\\mathrm{{id}}}$ 的差分性质。由此构造出如图 6-26 所示的 Class $\\mathrm{{AB}}$ 差分对输入,将 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{3}\\text{、}{\\mathrm{M}}_{2}/{\\mathrm{M}}_{4}$ 分别看成两个独立的组合 $\\mathrm{{MOS}}$ 管,并且尾电流分裂为两条相同的支路电流,即由原来 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{2}$ 的 NMOS 差分对,扩展为 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{3}\\text{、}{\\mathrm{M}}_{2}/{\\mathrm{M}}_{4}$ 的 CMOS 差分对。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_169_357_1666_859_326_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_169_357_1666_859_326_0.jpg)\n图 6-26 Class AB 差分对原型结构\nClass AB 差分输入级的具体实现中, 在交叉耦合的 NMOS 与 PMOS 差分管的栅极之间引入一辅助电压源 ${V}_{\\mathrm{M}} = {V}_{\\mathrm{x}} + {V}_{\\mathrm{{TH}},\\mathrm{{eq}}}$ ,当 ${V}_{\\mathrm{M}}$ 电压源中流过固定的偏置电流 $I$ 时,即可实现 ${V}_{\\mathrm{M}}$ 与 ${V}_{\\mathrm{{id}}}$ 是独立无关的常数。因此,利用 ${V}_{\\mathrm{M}}$ 固定电压偏置复合差分对管,使复合管等效 ${V}_{\\mathrm{{GS}}}$ 电压之和保持与 ${V}_{\\mathrm{{id}}}$ 无关,即可达到扩展线性范围的目的。一对 CMOS 组合管的总栅压为\n$$\n{V}_{\\mathrm{{GS}},\\mathrm{T}} = {V}_{\\mathrm{{GSn}}} + {V}_{\\mathrm{{GSp}}} = \\left( {\\frac{1}{\\sqrt{{k}_{\\mathrm{n}}}} + \\frac{1}{\\sqrt{{k}_{\\mathrm{p}}}}}\\right) \\sqrt{2I} + \\left( {{V}_{\\mathrm{{TN}}} + {V}_{\\mathrm{{TP}}}}\\right)  \\tag{6-46}\n$$\n将总的栅源电压表示成复合型单管等效的 ${V}_{\\mathrm{{GS}},\\mathrm{{eq}}}$ ,则有\n$$\n{V}_{\\mathrm{{GS}},\\mathrm{{eq}}} = {V}_{\\mathrm{{GS}},\\mathrm{T}} = \\frac{1}{\\sqrt{{k}_{\\mathrm{{eq}}}}}\\sqrt{2I} + {V}_{\\mathrm{{TH}},\\mathrm{{eq}}} = {V}_{\\mathrm{x}} + {V}_{\\mathrm{{TH}},\\mathrm{{eq}}} \\tag{6-47}\n$$\n式中,等效的增益因子、开启电压和过驱动电压分别为\n$$\n\\left. \\begin{array}{l} {k}_{\\mathrm{{eq}}} = \\frac{{k}_{\\mathrm{n}}{k}_{\\mathrm{p}}}{{\\left( \\sqrt{{k}_{\\mathrm{n}}} + \\sqrt{{k}_{\\mathrm{p}}}\\right) }^{2}} \\\\  {V}_{\\mathrm{{TH}},\\mathrm{{eq}}} = {V}_{\\mathrm{{TN}}} + {V}_{\\mathrm{{TP}}} \\\\  {V}_{\\mathrm{x}} = \\sqrt{\\frac{2I}{{k}_{\\mathrm{{eq}}}}} \\end{array}\\right\\}   \\tag{6-48}\n$$\n根据图 6-26 中 ${V}_{\\mathrm{M}}$ 电压源的偏置结构,设 CMOS 差分对与 ${V}_{\\mathrm{M}}$ 辅助电压源中 CMOS 组合管的等效增益因子 ${k}_{\\mathrm{{eq}}}$ 和等效开启电压 ${V}_{\\mathrm{{TH}},\\mathrm{{eq}}}$ 分别相同,即有 ${V}_{\\mathrm{i}} - \\left( {{V}_{\\mathrm{{GS}}1} + {V}_{\\mathrm{{GS}}3}}\\right)  + {V}_{\\mathrm{M}} = {V}_{\\mathrm{i}2}$ , 同时相对应,有 ${V}_{\\mathrm{i}2} - \\left( {{V}_{\\mathrm{{GS}}2} + {V}_{\\mathrm{{GS}}4}}\\right)  + {V}_{\\mathrm{M}} = {V}_{\\mathrm{i}1}$ ,则差分输入 ${V}_{\\mathrm{{id}}} = {V}_{\\mathrm{i}1} - {V}_{\\mathrm{i}2} = {V}_{\\mathrm{{GS}}1,\\mathrm{{eq}}} - {V}_{\\mathrm{M}} =$ ${V}_{\\mathrm{M}} - {V}_{\\mathrm{{GS}}2,\\mathrm{{eq}}}$ 。根据基本差分对原理,两独立 $\\mathrm{{CMOS}}$ 差分对管的输出饱和电流分别为\n$$\n\\left. \\begin{array}{l} {I}_{\\mathrm{{Dl}}} = \\frac{1}{2}{k}_{\\mathrm{{eq}}}{\\left( {V}_{\\mathrm{{GS}}1,\\mathrm{{eq}}} - {V}_{\\mathrm{{TH}},\\mathrm{{eq}}}\\right) }^{2} \\\\  {I}_{\\mathrm{D}2} = \\frac{1}{2}{k}_{\\mathrm{{eq}}}{\\left( {V}_{\\mathrm{{GS}}2,\\mathrm{{eq}}} - {V}_{\\mathrm{{TH}},\\mathrm{{eq}}}\\right) }^{2} \\end{array}\\right\\}   \\tag{6-49}\n$$\n差分输出电流为\n$$\n{I}_{\\mathrm{o}} = {I}_{\\mathrm{D}1} - {I}_{\\mathrm{D}2} = \\frac{1}{2}{k}_{\\mathrm{{eq}}}\\left( {{V}_{\\mathrm{{GS}}1,\\mathrm{{eq}}} + {V}_{\\mathrm{{GS}}2,\\mathrm{{eq}}} - 2{V}_{\\mathrm{{TH}},\\mathrm{{eq}}}}\\right) \\left( {{V}_{\\mathrm{{GS}}1,\\mathrm{{eq}}} - {V}_{\\mathrm{{GS}}2,\\mathrm{{eq}}}}\\right)  \\tag{6-50}\n$$\n由 ${V}_{\\mathrm{{GS}}1,\\mathrm{{eq}}} + {V}_{\\mathrm{{GS}}2,\\mathrm{{eq}}} = 2{V}_{\\mathrm{M}} = 2\\left( {{V}_{\\mathrm{x}} + {V}_{\\mathrm{{TH}},\\mathrm{{eq}}}}\\right)$ ,知 ${V}_{\\mathrm{{GS}}1,\\mathrm{{eq}}} - {V}_{\\mathrm{{GS}}2,\\mathrm{{eq}}} = \\left( {{V}_{\\mathrm{{id}}} + {V}_{\\mathrm{M}}}\\right)  - \\left( {{V}_{\\mathrm{M}} - }\\right.$ $\\left. {V}_{\\mathrm{{id}}}\\right)  = 2{V}_{\\mathrm{{id}}}$ 。通过 CMOS 差分结构和 ${V}_{\\mathrm{M}}$ 电平的移位作用, Class $\\mathrm{{AB}}$ 实现了在整个 ${V}_{\\mathrm{{id}}}$ 动态范围之内的线性输出, 即\n$$\n{I}_{\\mathrm{o}} = \\frac{1}{2}{k}_{\\mathrm{{eq}}}\\left( {2{V}_{\\mathrm{x}}}\\right) \\left( {2{V}_{\\mathrm{{id}}}}\\right)  = 2{k}_{\\mathrm{{eq}}}{V}_{\\mathrm{x}}{V}_{\\mathrm{{id}}} = 2\\sqrt{2{k}_{\\mathrm{{eq}}}I}{V}_{\\mathrm{{id}}} \\tag{6-51}\n$$\n图 6-27 给出了 Class AB 宽线性范围差分输入的原理图,并给出了线性范围等效于动态范围的控制原理。Class AB 的动态范围对应于 ${I}_{\\mathrm{D}1}$ 或 ${I}_{\\mathrm{D}2}$ 为零时的 ${V}_{\\mathrm{{id}}}$ 范围,根据 ${V}_{\\mathrm{{GSI}},\\mathrm{{eq}}} =$ ${V}_{\\mathrm{{id}}} + {V}_{\\mathrm{M}},{V}_{\\mathrm{{GS}}2,\\mathrm{{eq}}} = {V}_{\\mathrm{M}} - {V}_{\\mathrm{{id}}},{V}_{\\mathrm{M}} = {V}_{\\mathrm{x}} + {V}_{\\mathrm{{TH}},\\mathrm{{eq}}}$ 的基本约束关系,输出电流与差分输入电压的关系为\n$$\n\\left. \\begin{array}{l} {I}_{\\mathrm{D}1} = \\frac{1}{2}{k}_{\\mathrm{{eq}}}{\\left( {V}_{\\mathrm{{id}}} + {V}_{\\mathrm{x}}\\right) }^{2} \\\\  {I}_{\\mathrm{D}2} = \\frac{1}{2}{k}_{\\mathrm{{eq}}}{\\left( {V}_{\\mathrm{x}} - {V}_{\\mathrm{{id}}}\\right) }^{2} \\end{array}\\right\\}   \\tag{6-52}\n$$\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_171_838_252_546_584_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_171_838_252_546_584_0.jpg)\n图 6-27 Class AB 差分对结构示意图\n由 ${I}_{\\mathrm{D}1} = 0$ 及 ${I}_{\\mathrm{D}2} = 0$ 的条件,得到的 ${V}_{\\mathrm{{id}}}$ 范围为 $- {V}_{\\mathrm{x}} \\leq  {V}_{\\mathrm{{id}}} \\leq  {V}_{\\mathrm{x}}$ ,代入 ${V}_{\\mathrm{x}} = {\\left( 2I/{k}_{\\mathrm{{eq}}}\\right) }^{1/2}$ 的条件, 对应的输出差分电流的动态和线性范围为 $- {4I} \\leq  {I}_{\\mathrm{o}} \\leq  {4I}$ 。\n显然, Class $\\mathrm{{AB}}$ 差分放大电路中 ${V}_{\\mathrm{M}}$ 电平移位电路设置的偏置电流 $I$ 越大,实现的动态范围与线性范围也越大。同时, Class AB 差分对的跨导和电流驱动能力也随偏置电流 $I$ 的增加而提高。\n#### 6.5.5 线性化单元技术\n与 Class AB 的控制特性相类似, 通过采用多管组合的线性化技术, 也可提高差分输入电路的线性范围。图 6-28 给出了三管线性组合单元的原型结构。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_171_805_919_579_313_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_171_805_919_579_313_0.jpg)\n图 6-28 多管组合线性单元结构\n设 3 个 MOS 管的增益因子 $k$ 完全相同, ${V}_{\\mathrm{A}}$ 和 ${V}_{\\mathrm{B}}$ 分别为 ${\\mathrm{M}}_{1}$ 与 ${\\mathrm{M}}_{2}$ 管的 ${V}_{\\mathrm{{GS}}}$ 电压,其中 ${V}_{\\mathrm{C}} = {V}_{\\mathrm{A}} + {V}_{\\mathrm{B}}$ ,则 ${V}_{\\mathrm{B}} - {V}_{\\mathrm{A}} = 2{V}_{\\mathrm{B}} - {V}_{\\mathrm{C}} = {V}_{\\mathrm{C}} -$ $2{V}_{\\mathrm{A}}$ 。根据最简单的两管组合线性结构,获得输出差分电流为\n$$\n{I}_{2} - {I}_{1} = \\frac{k}{2}\\left( {{V}_{\\mathrm{C}} - 2{V}_{\\mathrm{{TH}}}}\\right) \\left( {{V}_{\\mathrm{B}} - {V}_{\\mathrm{A}}}\\right)  = \\frac{k}{2}\\left( {{V}_{\\mathrm{C}} - 2{V}_{\\mathrm{{TH}}}}\\right) \\left( {2{V}_{\\mathrm{B}} - {V}_{\\mathrm{C}}}\\right)  \\tag{6-53}\n$$\n显然,若 ${V}_{\\mathrm{C}}$ 为固定偏压常数,且 ${V}_{\\mathrm{B}} = {V}_{\\mathrm{i}}$ 时,差分电流即与输入电压 ${V}_{\\mathrm{i}}$ 呈线性关系。 由于 ${\\mathrm{M}}_{2}$ 管没有直流通路而无法正常工作,因此为实现两管组合单元的控制作用,应增加 ${\\mathrm{M}}_{3}$ 管并与 ${\\mathrm{M}}_{2}$ 管串联,形成 ${I}_{2}$ 电流的直流通路。 ${\\mathrm{M}}_{3}$ 与 ${\\mathrm{M}}_{2}$ 管的参数设计完全相同,在忽略衬底偏置效应的前提下,处于饱和工作区的 ${\\mathrm{M}}_{2}$ 与 ${\\mathrm{M}}_{3}$ 管的 ${V}_{\\mathrm{{GS}}}$ 相同。当输入信号加到 ${\\mathrm{M}}_{3}$ 管的栅极时, ${V}_{\\mathrm{i}} = {V}_{\\mathrm{{GS}}3} = {V}_{\\mathrm{{GS}}2} = {V}_{\\mathrm{B}}$ ,由此实现了差模电流与单端输入电压 ${V}_{\\mathrm{i}}$ 的线性关系, 即\n$$\n{I}_{2} - {I}_{1} = \\frac{k}{2}\\left( {{V}_{\\mathrm{C}} - 2{V}_{\\mathrm{{TH}}}}\\right) \\left( {2{V}_{\\mathrm{i}} - {V}_{\\mathrm{C}}}\\right)  \\tag{6-54}\n$$\n${\\mathrm{M}}_{3}$ 管饱和工作区限定的输入电压 ${V}_{\\mathrm{i}}$ 与偏置电压 ${V}_{\\mathrm{C}}$ 应满足的约束条件为\n$$\n\\left. \\begin{array}{l} {V}_{\\mathrm{C}} > 2{V}_{\\mathrm{{TH}}} \\\\  {V}_{\\mathrm{i}} \\geq  {V}_{\\mathrm{{TH}}} \\\\  {V}_{\\mathrm{i}} - {V}_{\\mathrm{{TH}}} = {V}_{\\mathrm{B}} - {V}_{\\mathrm{{TH}}},{V}_{\\mathrm{B}} - {V}_{\\mathrm{{TH}}} \\leq  {V}_{\\mathrm{A}},{V}_{\\mathrm{A}} = {V}_{\\mathrm{C}} - {V}_{\\mathrm{B}} \\end{array}\\right\\}   \\tag{6-55}\n$$\n即 $2{V}_{\\mathrm{B}} < {V}_{\\mathrm{C}} + {V}_{\\mathrm{{TH}}},{V}_{\\mathrm{A}}$ 使 ${\\mathrm{M}}_{1}$ 导通,则 ${V}_{\\mathrm{A},\\min } = {V}_{\\mathrm{{TN}}},{V}_{\\mathrm{A}}$ 使 ${\\mathrm{M}}_{2}$ 导通,则 ${V}_{\\mathrm{A},\\max } = {V}_{\\mathrm{C}} - {V}_{\\mathrm{{TN}}}$ , ${V}_{\\mathrm{A}}$ 的变化范围则为 ${V}_{\\mathrm{{TN}}} \\sim  {V}_{\\mathrm{C}} - {V}_{\\mathrm{{TN}}}$ 。与此相对应的, ${V}_{\\mathrm{B}}$ 使 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{2}$ 导通的动态范围为 ${V}_{\\mathrm{C}} - {V}_{\\mathrm{{TN}}} \\sim  {V}_{\\mathrm{{TN}}}$ ,进一步 ${\\mathrm{M}}_{3}$ 工作于饱和区下对 ${V}_{\\mathrm{B}}$ 即 ${V}_{\\mathrm{i}}$ 的动态范围改变为 ${V}_{\\mathrm{{TH}}} \\sim$ $\\left( {{V}_{\\mathrm{C}} + {V}_{\\mathrm{{TH}}}}\\right) /2$ 。因此,3 管组合线性单元在构成线性放大电路时存在两个严重的限制,首先是输入信号的共模范围受到限制, 共模抑制比低, 其次是输出电流中存在固有的直流失调项。因此, 将以上线形组合单元结构扩展到差分结构中, 有效克服了以上两类缺陷, 具体电路实现结构如图 6-29(a) 所示。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_172_346_565_886_515_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_172_346_565_886_515_0.jpg)\n图 6-29 基于组合线性结构的差分输入对\n对于图 6-29(a) 所示的 6 管组合线性差分结构,输出为两组线性组合单元差模电流的差分电流,用以消除支流直流偏移失调及扩展输入信号的共模范围 ${I}_{\\mathrm{o}} = {I}_{\\mathrm{a}} - {I}_{\\mathrm{b}}\\text{、}{I}_{\\mathrm{a}} = {I}_{4} +$ ${I}_{2}$ 、 ${I}_{\\mathrm{b}} = {I}_{1} + {I}_{5}$ ,整理后得 ${I}_{\\mathrm{o}} = \\left( {{I}_{2} - {I}_{1}}\\right)  - \\left( {{I}_{5} - {I}_{4}}\\right)$ 。代入单组线性组合单元的差模电流公式, 得到:\n$$\n{I}_{\\mathrm{o}} = \\frac{k}{2}\\left( {{V}_{\\mathrm{C}} - 2{V}_{\\mathrm{{TH}}}}\\right) \\left\\lbrack  {\\left( {2{V}_{\\mathrm{{il}}} - {V}_{\\mathrm{C}}}\\right)  - \\left( {2{V}_{\\mathrm{i}2} - {V}_{\\mathrm{C}}}\\right) }\\right\\rbrack   = k\\left( {{V}_{\\mathrm{C}} - 2{V}_{\\mathrm{{TH}}}}\\right) {V}_{\\mathrm{{id}}} \\tag{6-56}\n$$\n由于差分对仍然采用单一的源极耦合尾电流源,因此差分对 ${V}_{id}$ 的动态范围与普通差分对动态范围的关系式完全相同,即 ${V}_{\\mathrm{{id}},\\max } = {\\left( 4I/k\\right) }^{1/2}$ 。该电路并没有完全解决输入共模信号范围向上扩展的问题,当 ${V}_{\\mathrm{{ic}}}$ 增加时,源电位 ${V}_{\\mathrm{S}}$ 相应提高,但 ${V}_{\\mathrm{S}}$ 的上限范围受到限制,即 ${V}_{\\mathrm{S}} < {V}_{\\mathrm{C}} - {V}_{\\mathrm{{TN}}}$ ,且 ${V}_{\\mathrm{S}}$ 过高后还使 ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{4}$ 进入线性区。\n在图 6-29(b) 的改进结构中,为了避免 ${V}_{\\mathrm{S}}$ 电位变化对 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{4}$ 电流的影响,分别增加了 ${\\mathrm{M}}_{7}$ 和 ${\\mathrm{M}}_{8}$ 串联的隔离 PMOS 管,其 $W/L$ 远大于 NMOS 的 $W/L$ ,即交流阻抗远低于 NMOS 交流阻抗而近似为零,所以仍然保持以上分析的交流输出电流关系。然而,由于 ${V}_{\\mathrm{C}2}$ 和 ${V}_{\\mathrm{{TP}}}$ 的作用, ${\\mathrm{M}}_{1}/{\\mathrm{M}}_{4}$ 管的源电位直流电平上升了 ${V}_{\\mathrm{C}2} + {V}_{\\mathrm{{TP}}}$ 值,导致 ${V}_{\\mathrm{{Cl}}}$ 也会有同等幅度的增加。 ${\\mathrm{M}}_{2}/{\\mathrm{M}}_{5}$ 实际构成了一种套筒式 Cascode 差分增益结构,进一步的分析表明,当其偏置 ${V}_{\\mathrm{C}}$ 提高时,差分输出的电压摆幅明显下降。因此,对于 $\\mathrm{N}$ 型输入的此类型差分结构, 比较适合处理具有较低共模电平的差模信号。"
}