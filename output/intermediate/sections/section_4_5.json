{
  "section_num": "4.5",
  "title": "电流基准",
  "start_line": 2857,
  "end_line": 2990,
  "content": "### 4.5 电流基准\n电流基准由电流偏置发展而来。以上电流求和的思想完全可以借鉴到基准电流的设计中。与电压基准的补偿原理相同,采用固定正温度系数的电流即 PTAT 电流,与 ${V}_{\\mathrm{{BE}}}/R$ 相关的负温度系数进行叠加求和,获得与温度近似无关的零温度系数电流。图 4-34 所示的电压 $\\mathrm{{BGR}}$ 电路,经过适当的参数调节可使输出的正负温度系数电流在输出管中很好地进行补偿,成为电流基准电路。温度稳定的电流基准从某种意义上看其应用比电压基准更广、影响更大,因为电流基准提供系统中各种需要的电流偏置,对提高电路工作的温度稳定性起主导作用。\n#### 4.5.1 基于 $V - I$ 转换的电流基准\n在电流模带隙电压基准中用到的电流模技术,对于基准中的求和电流,电阻温度特性对电流的温度系数有明显影响, 但电阻比却使输出电压的温度系数免受电阻的影响。因此, 如果电阻温度系数很小, 或通过性质相反的两个电阻进行补偿使其等效温度系数降低到零, 则电流温度系数也不受电阻的影响。换言之, 通过零温漂的基准电压源与零温度系数电阻, 可以近似得到零温度系数基准电流,即 ${I}_{\\mathrm{R}} = {V}_{\\text{ref }}/R$ 。这种基于基准电压到输出基准电流的转换结构如图 4-35 所示。定义的基准电流可以通过 PMOS 电流镜提供各 PMOS 管的偏置, 同时, 由 PMOS 基准电流转换成 NMOS 电流镜电流, 也完成了基准零温度系数电流对 NMOS 的偏置。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_109_903_1183_496_360_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_109_903_1183_496_360_0.jpg)\n图 4-35 利用基准源产生偏置电流的原理图\n采用 Cascode 电流镜可提高电流 ${I}_{\\mathrm{R}}$ 与电源电压的无关性。若电阻有较大的温度系数,导致该电流残存一定的温度系数。利用不同类型电阻具有正负温度系数的性质进行补偿设计, 是减小输出电流温度系数的一种有效方法, 但补偿的效果受到不同类型电阻阻值及其温度特性的限制。电阻的温度系数不但对电流基准有影响, 而且对电压基准也产生复杂的作用。电压基准的温度特性出现了非单调的曲线分布, 与前面讨论的单调开口向上或开口向下特性并不完全吻合。其原因之一就是在电阻温度特性的简单分析中假设了电阻的一阶线性系数, 实际上电阻的温度系数本质上也是非线性的。在 HSPICE 模型中, 对电阻采用两阶温度系数的方式以描述其非线性温度特性, 即\n$$\nR\\left( T\\right)  = {R}_{0}\\left\\lbrack  {1 + {T}_{\\mathrm{C}1}\\left( {T - {T}_{0}}\\right)  + {T}_{\\mathrm{C}2}{\\left( T - {T}_{0}\\right) }^{2}}\\right\\rbrack   = {R}_{0}f\\left( T\\right)  \\tag{4 - 61}\n$$\n式中, ${T}_{\\mathrm{C}1}$ 和 ${T}_{\\mathrm{C}2}$ 为电阻的一阶和二阶的定值温度系数,其正负性质和数值大小与电阻材料和具体的加工工艺有关。这两种温度系数对电阻影响的作用范围是不同的, ${T}_{\\mathrm{{Cl}}}$ 系数在常温 ${T}_{0}$ 附近起主导作用, ${T}_{\\mathrm{C}2}$ 系数则在远离 ${T}_{0}$ 的高温和低温范围影响显著增加。不同的 ${T}_{\\mathrm{C}1}$ 和 ${T}_{\\mathrm{{C2}}}$ 系数的组合,决定了电阻所具有的正负温度性质及其温度特性变化的大小。\n对于正温度系数 ${R}_{\\mathrm{p}}\\left( T\\right)$ 和负温度系数 ${R}_{\\mathrm{n}}\\left( T\\right)$ ,设 ${\\Delta T} = T - {T}_{0}$ ,则分别有\n$$\n{f}_{\\mathrm{P}}\\left( T\\right)  = 1 + {T}_{\\mathrm{{Cp}},1}{\\Delta T} + {T}_{\\mathrm{{Cp}},2}{\\left( \\Delta T\\right) }^{2} \\tag{4-62}\n$$\n$$\n{f}_{\\mathrm{n}}\\left( T\\right)  = 1 + {T}_{\\mathrm{{Cn}},1}{\\Delta T} + {T}_{\\mathrm{{Cn}},2}{\\left( \\Delta T\\right) }^{2}\n$$\n如以负温度系数电阻为参照 (系数为 1 ),调节正温度系数电阻的比例量,设其系数为 $\\alpha$ , 则组合得到的电阻 ${R}_{\\mathrm{C}}\\left( T\\right)$ 具有的温度特性为\n$$\n{f}_{\\mathrm{C}}\\left( T\\right)  = \\left( {1 + \\alpha }\\right)  + \\left( {{T}_{\\mathrm{{Cn}},1} + \\alpha {T}_{\\mathrm{{Cp}},1}}\\right) {\\Delta T} + \\left( {{T}_{\\mathrm{{Cn}},2} + \\alpha {T}_{\\mathrm{{Cp}},2}}\\right) {\\left( \\Delta T\\right) }^{2} \\tag{4-63}\n$$\n为获得最小的温度系数, ${f}_{\\mathrm{C}}\\left( T\\right)$ 对 $T$ 即 ${\\Delta T}$ 的一阶导数应为零,由此得\n$$\n{f}_{\\mathrm{C}}^{\\prime }\\left( T\\right)  = \\left( {{T}_{\\mathrm{{Ca}},1} + \\alpha {T}_{\\mathrm{{Cp}},1}}\\right)  + 2\\left( {{T}_{\\mathrm{{Ca}},2} + \\alpha {T}_{\\mathrm{{Cp}},2}}\\right) {\\Delta T} = 0 \\tag{4 - 64}\n$$\n根据此式解的出的比例系数与温度变化范围有关, 即\n$$\n\\alpha  =  - \\frac{{T}_{\\mathrm{{Cn}},1} + 2{T}_{\\mathrm{{Cn}},2}{\\Delta T}}{{T}_{\\mathrm{{Cp}},1} + 2{T}_{\\mathrm{{Cp}},2}{\\Delta T}} =  - \\frac{{T}_{\\mathrm{{Cn}},1}}{{T}_{\\mathrm{{Cp}},1}}\\frac{1 + \\left( {2{T}_{\\mathrm{{Cn}},2}/{T}_{\\mathrm{{Cn}},1}}\\right) {\\Delta T}}{1 + \\left( {2{T}_{\\mathrm{{Cp}},2}/{T}_{\\mathrm{{Cp}},1}}\\right) {\\Delta T}} \\tag{4-65}\n$$\n因此,在 ${T}_{0}$ 附近,由于 ${\\Delta T} \\approx  0$ ,为得到最小温度系数其正温度系数电阻与负温度系数电阻阻值之间的比例关系应为 $\\alpha  =  - {T}_{\\mathrm{{Cn}},1}/{T}_{\\mathrm{{Cp}},1}$ ,由于 ${T}_{\\mathrm{{Cn}},1}$ 和 ${T}_{\\mathrm{{Cp}},1}$ 的数值相反,得到一个正实数的 $\\alpha$ 系数,而串联复合电阻整体的温度系数与总电阻的绝对数值大小无关。电阻的大小主要根据支路电流确定。通常以高阻值电阻占据复合电阻的主要部分, 低阻成分则根据以上计算得到的 $\\alpha$ 或 $1/\\alpha$ 进行选择。\n由于电阻温度特性的非线性本质,以上得到复合电阻的温度补偿仅在 ${\\Delta T} \\approx  0$ 即室温附近很小的一段范围内有效。当温度范围增大时, 补偿的效果明显变差。为此, 由 (4-65) 式分别计算在最高和最低两个温度点所需要的补偿系数 ${\\alpha }_{\\mathrm{H}}$ 和 ${\\alpha }_{\\mathrm{L}}$ ,与前面计算得到的在中心温度点下所需要的补偿系数 ${\\alpha }_{0}$ ,实际补偿系数取三者的平均,可兼顾到高中低温不同温度范围内的补偿要求。分析式(4-65)还发现,当满足 ${T}_{\\mathrm{{Cn}},1}/{T}_{\\mathrm{{Cn}},2} = {T}_{\\mathrm{{Cp}},1}/{T}_{\\mathrm{{Cp}},2}$ 时,补偿效果最好,此时补偿系数 $\\alpha$ 与温度范围 ${\\Delta T}$ 无关。这预示着在选取补偿电阻时,应选择那些温度系数符合或接近以上比例关系的不同类型电阻。由于实际基准电压总是存在残余的温度系数,通常可用 2 次温度项表示,则计算得到的电阻补偿系数 $\\alpha$ 也应作相应的调整。 $\\alpha$ 的调整应使组合电阻的 2 次温度项的各次系数与基准相应的系数匹配, 从而获得最优的补偿效果。这种参数调节通常并不存在唯一的解,需要通过多次模拟才能完成。\n#### 4.5.2 基于偏置控制的电流基准\n与绝对温度成正比的 PTAT 电流是一种常用的偏置电流, 具有结构简单且控制稳定的特点,同时为电压基准电路所必需。然而,当 PTAT 作为系统偏置时,将产生电路性能随温度变化而漂移的严重问题。对于采用零温度系数偏置电流的温度稳定电路,借鉴电压基准零温度系数补偿的基本原理,采用基于PTAT正温度系数电流与基于 ${V}_{\\mathrm{{BE}}}$ 生成负温度系数电流两者叠加求和的方法, 通过独立调节正负温度系数间的比例关系, 获得近似与温度无关的电流偏置特性。这种常规的零温度系数偏置电流控制获得了广泛的应用。\n对于基本的 PTAT 结构, 电阻的温度系数以及电路中关键静态工作点电压的失配都将影响输出电流的温度系数, 使输出电流偏离原有的 PTAT 特性。这一点给出了关键的启示,若采用特定方法即人为控制的方式利用以上失配效应的影响,有可能将 PTAT 电流输出转变到近似零温度系数输出。具体而言,在保留 $\\Delta {V}_{\\mathrm{{BE}}}$ 对电流的正温度系数贡献外, 同时还应利用电阻的温度系数以及非匹配 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{2}$ 管 $\\Delta {V}_{\\mathrm{{GS}}}$ 所产生的电流负温度系数的作用。在电路结构基本保持不变的条件下, 仅通过器件参数的调节, 实现零温度系数偏置电流输出。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_111_982_501_411_571_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_111_982_501_411_571_0.jpg)\n图 4-36 零温度系数电流源电路\n基于对 PTAT 改进的零温度系数电流偏置结构如图 $4 - {36}$ 所示,该电路采用电阻 ${R}_{3}$ 自偏置的 PMOS Cascade 电流镜以提高两支路电流 ${I}_{1} = {I}_{2}$ 的匹配精度。相对于原 PTAT 结构, 可同时采用以下两种方式引入失配以实现对温度特性的调节。一是改变 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{2}$ 管 $W/L$ 的比例关系使 ${V}_{\\mathrm{X}} \\neq  {V}_{\\mathrm{Y}}$ ,其次为增加 ${R}_{1}$ 电阻,并控制 ${R}_{1}$ 与 ${R}_{2}$ 的差值。\n保持电路两支路电流相同的条件下, 各支路电压及电流满足以下约束方程, 即\n$$\n{V}_{\\mathrm{{GSI}}} + {I}_{1}{R}_{1} + {V}_{\\mathrm{{BE}}1} = {V}_{\\mathrm{{GS}}2} + {I}_{2}{R}_{2} + {V}_{\\mathrm{{BE}}2} \\tag{4-66}\n$$\n在两种失配控制中,首先考虑各自独立的控制作用,即先分析 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{2}$ 对管失配 $\\Delta {V}_{\\mathrm{{GS}}}$ 对温度特性的影响,而暂不考虑电阻作用。此时,若 ${R}_{1} = {R}_{2}$ ,则上式简化为 ${V}_{\\mathrm{{GS}}2} - {V}_{\\mathrm{{GS}}1} = {V}_{\\mathrm{{BE}}1} -$ ${V}_{\\mathrm{{BE}}2}$ 。由于 $N > 1$ ,则有 ${V}_{\\mathrm{{BE}}1} > {V}_{\\mathrm{{BE}}2}$ ,所以 ${V}_{\\mathrm{{GS}}1} < {V}_{\\mathrm{{GS}}2}$ 。根据 $\\mathrm{{MOS}}$ 管饱和电流公式,在电流恒定下, ${V}_{\\mathrm{{GS}}}$ 小则其 $W/L$ 大,因此取 ${\\left( W/L\\right) }_{1} = m{\\left( W/L\\right) }_{2}$ ,或 ${k}_{1} = m{k}_{2}$ ,其中 $m > 1$ 。\n由于 ${V}_{\\mathrm{X}}$ 与 ${V}_{\\mathrm{Y}}$ 均大于零, ${\\mathrm{M}}_{1}$ 与 ${\\mathrm{M}}_{2}$ 均存在衬偏效应,并且 ${V}_{\\mathrm{X}} \\neq  {V}_{\\mathrm{Y}}$ ,则衬偏效应的失配对 ${V}_{\\mathrm{X}}\\text{、}{V}_{\\mathrm{Y}}$ 电压产生影响,忽略此影响可简化 $\\Delta {V}_{\\mathrm{{GS}}} = {V}_{\\mathrm{X}} - {V}_{\\mathrm{Y}}$ 的计算,但将带来一定的误差。由 $\\Delta {V}_{\\mathrm{{GS}}} = {V}_{\\mathrm{{GS2}}} - {V}_{\\mathrm{{GS1}}}$ ,在饱和工作区并忽略 NMOS 管衬偏效应影响的条件下, 可得\n$$\n\\Delta {V}_{\\mathrm{{GS}}} = \\sqrt{\\frac{2{I}_{2}}{{k}_{2}}} - \\sqrt{\\frac{2{I}_{1}}{{k}_{1}}} = \\sqrt{\\frac{2{I}_{2}}{{k}_{2}}}\\left( {1 - \\frac{1}{\\sqrt{m}}}\\right)  \\tag{4 - 67}\n$$\n式中增益因子 $k$ 的温度系数主要由迁移率 $\\mu$ 决定,即 $\\mu  \\propto  {\\mu }_{0}{\\left( T/{T}_{0}\\right) }^{-3/2}, k =$ ${\\mu }_{0}{C}_{\\mathrm{{OX}}}\\left( {W/L}\\right) {\\left( T/{T}_{0}\\right) }^{-3/2}$ 。由 $\\Delta {V}_{\\mathrm{{GS}}} = \\Delta {V}_{\\mathrm{{BE}}}$ 的条件,可得\n$$\n{I}_{2} = \\frac{1}{2}{k}_{2}\\frac{m}{m - 2\\sqrt{m} + 1}{\\left( {V}_{\\mathrm{T}}\\ln N\\right) }^{2} \\tag{4 - 68}\n$$\n以上非线性电流关系不但决定了偏置电流的大小, 而且决定了该电流的温度系数, 即考虑 ${k}_{2}$ 与 ${V}_{\\mathrm{T}}$ 的温度特性后,偏置电流 $I \\propto  {T}^{1/2}$ ,呈正温度特性,但已偏离原有的 PTAT 规律,需要进一步引入新的温度系数调节因子。利用失配电阻可实现对电流温度系数的进一步调节,令 ${\\Delta R} = {R}_{1} - {R}_{2}$ ,基本约束条件为\n$$\n\\sqrt{\\frac{2{I}_{2}}{{k}_{2}}}\\left( {1 - \\frac{1}{\\sqrt{m}}}\\right)  = {V}_{\\mathrm{T}}\\ln N + {I}_{2}{\\Delta R} \\tag{4-69}\n$$\n对上式两边求偏导,并利用所需的 $\\partial {I}_{2}/\\partial T = 0$ 控制结果,则对应的控制条件为\n$$\n- \\sqrt{\\frac{{I}_{2}}{2}}\\frac{\\sqrt{m} - 1}{\\sqrt{m}}{k}_{2}^{-\\frac{3}{2}}\\frac{\\partial {k}_{2}}{\\partial T} = \\frac{{V}_{\\mathrm{T}0}\\ln N}{{T}_{0}} + {I}_{2}\\frac{\\partial {\\Delta R}}{\\partial T} \\tag{4-70}\n$$\n代入 ${k}_{2}$ 的温度关系,经整理并将相关系数归入 $\\alpha$ 中,得\n$$\n\\alpha  = \\frac{3\\sqrt{2}}{4}\\frac{1 - 1/\\sqrt{m}}{\\sqrt{{k}_{2}\\left( {T}_{0}\\right) }} \\tag{4 - 71}\n$$\n由于 $m > 1$ ,且 $\\alpha  > 0$ ,则以上方程所对应的温度约束条件为\n$$\n\\alpha \\sqrt{{I}_{2}}{T}^{-\\frac{1}{4}} - {I}_{2}\\frac{\\partial {\\Delta R}}{\\partial T} = \\frac{{V}_{\\mathrm{T}0}\\ln N}{{T}_{0}} \\tag{4 - 72}\n$$\n通过设置 ${\\Delta R}$ 与电流 ${I}_{2}$ 的值,可使某一温度点如 ${T}_{0}$ 下以上约束条件得到满足。由于是多参量调节, ${\\Delta R}$ 与电流的设计方案并不唯一。显然,由于约束条件应在 $\\partial I/\\partial T = 0$ 成立的宽温度范围内均能满足,则 ${\\Delta R}$ 、 $I$ 应存在一组最优设计,同时满足零温度系数电流的温度范围宽,温度系数更低。\n由上式可知,方程右边为与温度无关的正数,则 $\\partial {\\Delta R}/\\partial T$ 应避免取值过大,以保证方程左边也为正值,因此 ${\\Delta R}$ 应取小的正温度系数或负温度系数。进一步,为实现式 (4-72) 在宽的温区成立,对其求温度的偏导,可得\n$$\n\\frac{\\partial \\left( {\\partial {\\Delta R}/\\partial T}\\right) }{\\partial T} =  - \\frac{1}{4}\\alpha \\frac{1}{\\sqrt{{I}_{2}}}{\\left( T/{T}_{0}\\right) }^{-\\frac{5}{4}} \\tag{4 - 73}\n$$\n即 ${\\Delta R}$ 电阻关于 $T$ 的二阶导数必须小于零,即 $\\Delta {R}^{\\prime \\prime } < 0$ 。与其他零温度系数电流控制不同的是,偏置电流自身的大小对约束条件的成立及其温度范围有显著影响。增大电流 ${I}_{2}$ 或者减小 $\\alpha$ 即减小 $m$ ,可显著抑制约束条件式 (4-72) 中温度特性的影响,使零温度系数基准电流的约束条件在更广的温度范围内都能成立。\n根据电阻的两阶温度特性,差值电阻的一阶和两阶温度导数为\n$$\n\\frac{\\partial {\\Delta R}}{\\partial T} = \\Delta {R}_{0}\\left\\lbrack  {{T}_{C1} + 2{T}_{\\mathrm{C}2}\\left( {T - {T}_{0}}\\right) }\\right\\rbrack   \\tag{4 - 74}\n$$\n$$\n\\frac{\\partial \\left( {\\partial {\\Delta R}/\\partial T}\\right) }{\\partial T} = {2\\Delta }{R}_{0}{T}_{\\mathrm{C}2}\n$$\n当采用多晶电阻时,由于 ${T}_{\\mathrm{C}1} < 0,{T}_{\\mathrm{C}2} > 0$ 。则由 $\\Delta {R}^{\\prime \\prime } < 0$ 的约束条件,得到 $\\Delta {R}_{0} < 0$ , 即 ${R}_{1} < {R}_{2}$ ,并由以上两式的约束选取一最优的 $\\Delta {R}_{0}$ 值,使偏置电流的温度系数最低且零温度系数的温度范围最宽。\n基于 $\\Delta {V}_{\\mathrm{{GS}}}$ 和 $\\Delta {R}_{0}$ 控制的零温度偏置电流设计,具有十分简单的电路结构及调节灵活性。其中,无论采用何种类型的电阻,即无论电阻的温度系数如何,均可通过 $\\Delta {R}_{0}$ 电阻差的极性控制并调节差值电阻的温度特性,最终获得某一偏置水平下的零温度系数电流输出。 此外,通过复合电阻改变其 ${T}_{\\mathrm{C}}$ 温度系数,可进一步提高电流的温度稳定性。考虑到 CMOS 工艺中多晶电阻具有工艺重复精度高以及较好的电压系数,因此 ${\\Delta R}$ 选用多晶低阻和 $1\\mathrm{\\;k}\\Omega$ 的高阻形成的复合电阻。其一般设计过程是首先估算出需要的电流值所对应的 $m$ 和 $N$ 值,然后在估算出的 $m$ 和 $N$ 值的基础上精确调节 $N$ 及 $m$ 因子及 ${\\Delta R}$ ,调节各参数最终使其满足最小温度系数。\n不同偏置电流下,在 $- {30}^{ \\circ  }\\mathrm{C} \\sim  {135}^{ \\circ  }\\mathrm{C}$ 温度范围内,温度系数可控制在 ${100} \\times  {10}^{-6}/{}^{ \\circ  }\\mathrm{C}$ 数量级以内,并且随着偏置电流的增大和 $m$ 的减小,温度系数降低,符合上述增大偏置电流减小 $m$ 可降低温度系数的理论推导。对于常规的应用,这种基于广义失调控制的电路结构和参数设计,可基本满足低功耗条件下温度稳定偏置的设计要求。"
}