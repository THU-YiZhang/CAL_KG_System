{
  "section_num": "12.4",
  "title": "轨至轨输出级",
  "start_line": 10403,
  "end_line": 10806,
  "content": "### 12.4 轨至轨输出级\n在轨至轨运放系统中,输入级只是运放的一部分,为了充分发挥输入级的恒跨导特性, 必须有良好的输出级与之相匹配。静态条件下,当输出级仅驱动容性负载时,对输出电流驱动能力的要求不高,输出静态电流的下限条件为满足系统带宽要求。对于阻性负载驱动,除满足高频下的带宽要求外,输出级的静态电流必须满足负载驱动能力的要求,即提供宽电压摆幅下的大电流输出。\n大的负载电流输出带来两方面的问题,即效率和失真,而且两者对静态电流的要求完全相反。这里,将输出级可以输出的最大变化电流 ${I}_{\\mathrm{L}}$ 与总电流 ${I}_{\\mathrm{Q}} + {I}_{\\mathrm{L}}$ 的比值定义为输出级的电流效率,即 $\\eta  = {I}_{\\mathrm{L}}/\\left( {{I}_{\\mathrm{Q}} + {I}_{\\mathrm{L}}}\\right)$ ,其中 ${I}_{\\mathrm{Q}}$ 为输出级不带负载时的静态偏置电流。为了得到优异的电流效率, 在输出电压范围接近整个电源电压摆幅条件下, 输出级空载下应该偏置在小的静态电流下,同时在大负载条件下能够提供大的输出电流。从失真的角度出发,当输出级驱动的负载电流变化很大时,电路增益变化增大,而增益的变化导致小信号处理的非线性失真增大。\n因此, 输出级结构设计应当在功耗、效率、频率特性和失真等性能参数之间折中, 应当选取合适的输出级结构满足以上各种要求, 并通过合适的静态点参数设计, 使输出级性能达到最优。\n#### 12.4.1 基本输出级结构比较\n基本的输出级结构共有三类。第一类是 CS 增益输出级, 该类输出级的主要优点是电压增益高、输出摆幅大,缺点是输出阻抗高,电流驱动能力小,因此通常只用于输出驱动容性负载。第二类是 CS 源跟随器输出, 该类输出结构的主要优点是输出阻抗小, 电流驱动能力强,偏置简单易控,缺点是输出摆幅范围下降。以上两类输出级通常工作于 Class A 模式, 失真小但转换效率难以提高。第三类是互补推挽输出结构,特点是负载电流驱动能力强,输出电压摆幅大,缺点则为静态工作点对电路的效率和失真影响显著。\n因此, 为满足宽摆幅电阻负载的基本驱动要求, 通常选择互补推挽驱动的电路结构, 这在第五章的单元电路分析中已有全面阐述。现从失真的角度出发, 分析互补推挽驱动静态工作点的设置以及实际电路结构的设计问题。假设一多级运放, 考虑非线性影响, 与输入信号 ${V}_{\\text{in }}$ 相关的开环增益为 ${A}_{\\mathrm{v}}$ ,将此开环前馈连接成单位增益跟随形式,则闭环增益 ${A}_{\\mathrm{f}}\\left( {V}_{\\text{in }}\\right)$ 关于输入信号的变化关系为\n$$\n\\frac{\\partial {A}_{\\mathrm{f}}\\left( {V}_{\\mathrm{{in}}}\\right) }{\\partial {V}_{\\mathrm{{in}}}} = \\frac{{A}_{\\mathrm{v}}^{\\prime }\\left( {1 + {A}_{\\mathrm{v}}}\\right)  - {\\left( 1 + {A}_{\\mathrm{v}}\\right) }^{\\prime }{A}_{\\mathrm{v}}}{{\\left( 1 + {A}_{\\mathrm{v}}\\right) }^{2}} = \\frac{\\partial {A}_{\\mathrm{v}}/\\partial {V}_{\\mathrm{{in}}}}{{\\left( 1 + {A}_{\\mathrm{v}}\\right) }^{2}} \\tag{12 - 24}\n$$\n闭环增益随输入信号的变化是引起信号失真的一个主要因素, 就如同闭环增益随频率变化而引起的信号失真一样。信号时域内的失真,称为静态失真；信号频域内的失真,称为动态失真。根据失真的性质可分为非线性失真和线性失真;根据引起失真的原因可分为静态失真和动态失真。可见,静态失真或动态失真可包括非线性失真和线性失真。就时域内的静态失真而言,开环增益 ${A}_{\\mathrm{v}}$ 越大,或者在 ${A}_{\\mathrm{v}}$ 不随输入信号 ${V}_{\\text{in }}$ 变化的情况下,非线性失真越小。相反,如果开环增益不是足够大,而且随输入信号变化有较大的变化时,这时增益的变化就会产生比较严重的失真,失真的大小由开环增益相对输入信号变化的斜率决定。\n引起开环增益随输入信号变化的因素除了输入跨导 ${g}_{\\mathrm{m}}$ 的非线性外,还有输出级跨导 ${g}_{\\mathrm{{mL}}}$ 的非线性或者输出电流的变化。因此,对于轨至轨运放系统,不但要求输入跨导 ${g}_{\\mathrm{m}}$ 恒定,还要求其增益恒定,即输出跨导 ${g}_{\\mathrm{{ml}}}$ 或输出静态电流恒定,以抑制闭环系统的非线性失真。\n输出级静态电流对输出级跨导的恒定特性有重要影响。随着输出电流的增加, 输出晶体管的跨导增大, 由于跨导与电流平方根成正比而非线性关系, 输出电流越大, 跨导值的相对变化越小, 失真越小; 而当电流趋近零时, 其跨导降到最低, 运放的开环增益达到最大, 但在亚阈区增益为固定常数,失真反而最小,只有在强反型状态的低电流驱动下,失真才大幅增大。若提供给负载的电流远小于偏置电流, 则图 12-15 的偏置电流变化很小, 选择一个合适的静态点,作为输出级的偏置而构成 Class A 类放大电路,此时失真最小。虽然表现出优异的线性特性,但 $A$ 类电路的电流效率很低,在输出大电流的应用中无法使用。\n因此, 低压运放的输出级通常选择 Class AB 互补推挽放大结构, 以满足以下 3 方面的基本要求:\n(1)输出电压的轨至轨摆幅,以充分利用电源电压；\n(2)提高负载的电流驱动能力,同时降低失真；\n(3)应不影响前级对输出级的驱动,前级提供的输出信号直接驱动输出级应无过大的延迟,以提高单位电源电压下的电路带宽。\n传统的 $\\mathrm{{CD}}$ 源跟随互补驱动结构由于输出动态范围损失较大,难以用于低电源电压电路,只有采用 $\\mathrm{{CS}}$ 的互补驱动。对于 Class $\\mathrm{{AB}}$ 的具体偏置点,应当满足以下基本要求:\n(1)最大驱动电流 ${I}_{\\max }$ 与静态工作点电流 ${I}_{\\mathrm{Q}}$ 的比值应足够大,满足效率限制要求；\n(2)最小驱动电流 ${I}_{\\min }$ 与 ${I}_{\\mathrm{Q}}$ 的差距应尽可能小,两者充分接近并使 ${I}_{\\min } > 0$ 以提高电路的动态响应速度,降低高频失真；\n(3) ${I}_{\\mathrm{Q}}$ 值选择应考虑效率和失真的共同要求, ${I}_{\\mathrm{Q}}$ 不能过低,以保证 Class AB 转折区的平稳, 从而减小低频失真。\n因此,互补驱动 CS 输出级 Class AB 控制的难点在于静态工作点的设定,而工作点设定的关键又在于 Class AB 控制电路的设计, 控制电路设计的关键则在于反馈或前馈结构的确定及其参数优化。\n#### 12.4.2 反馈型 Class AB 偏置技术\n反馈偏置技术的优势在于设计的自由性和 Class AB 控制的高精确性。设计的自由度来自于输出级电流检测和 Class AB 控制原理的实现两者相分离。提高 Class AB 控制环路的增益可以实现控制的高精度。但是, 使用反馈电路的风险是可能产生振荡, 因此稳定性的问题必须解决。反馈系统的稳定性成为电路结构选择的重要依据之一。\n## 1)反馈控制结构\n反馈控制结构提供 Class AB 合适的静态工作点,以及输出功率管的最大及最小驱动电流。当输出管最小电流为零时,为截止型 Class AB 输出驱动,否则,当最小电流大于零则为非截止型 Class AB 输出驱动。Class AB 的静态电流通常高于驱动管的最小电流, 非截止型相比截止型在响应速度方面有较大优势,但以牺牲电流效率为代价。\n反馈环路控制实现 Class AB 偏置的原理如图 12-15 所示。反馈型 Class AB 输出级需要两个输入控制信号 ${V}_{\\text{inl }}$ 和 ${V}_{\\text{in 2 }},{\\mathrm{M}}_{3}$ 按比例将 ${\\mathrm{M}}_{1}$ 中的电流复制到控制电路,同样 ${\\mathrm{M}}_{4}$ 将 ${\\mathrm{M}}_{2}$ 中的电流按比例复制到控制电路,控制电路由此产生一个电压 ${V}_{\\mathrm{C}}$ 与一个参考电压 ${V}_{\\text{ref }}$ 比较,比较的结果反馈控制输入信号 ${V}_{\\text{inl }}$ 和 ${V}_{\\text{in2 }}$ ,迫使控制电路的输出电压为参考电压,同时维持稳定的输出控制偏置。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_360_208_1134_602_369_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_360_208_1134_602_369_0.jpg)\n图 12-15 反馈型 Class AB 控制原理\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_360_904_1135_411_369_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_360_904_1135_411_369_0.jpg)\n图 12-16 线性电压 Class AB 类控制电路\n根据以上原理,图 12-16 构造了一种简单的 Class $\\mathrm{{AB}}$ 线性电压控制电路, ${\\mathrm{M}}_{4}$ 管的栅电位为控制电路的输出 ${V}_{\\mathrm{C}}$ ,其电位被反馈环路固定在 ${V}_{\\mathrm{{ref}}}$ 的参考电位,同时在控制电路的 ${\\mathrm{M}}_{4}$ 支路中形成恒定的 ${I}_{\\mathrm{Q}}$ 电流。设 ${I}_{11}$ 和 ${I}_{12}$ 分别为输出晶体管电流 ${I}_{1}\\text{、}{I}_{2}$ 的等比例镜像采样电流,比例系数 $C \\gg  1$ 。若控制电路中 ${\\mathrm{M}}_{1} - {\\mathrm{M}}_{4}$ 管的增益因子 $k$ 均相等,根据此 TL 环路中 ${V}_{\\mathrm{{GS}}4} + {V}_{\\mathrm{{GS}}3} = {V}_{\\mathrm{{GS}}2} + {V}_{\\mathrm{{GS}}1}$ 的条件,并忽略衬偏效应,可得\n$$\n\\left( {{V}_{\\mathrm{{TN}}} + \\sqrt{2{I}_{\\mathrm{Q}}/k}}\\right)  + \\left( {{V}_{\\mathrm{{TP}}} + \\sqrt{2{I}_{\\mathrm{Q}}/k}}\\right)  = \\left( {{V}_{\\mathrm{{TP}}} + \\sqrt{2{I}_{12}/k}}\\right)  + \\left( {{V}_{\\mathrm{{TN}}} + \\sqrt{2{I}_{11}/k}}\\right)\n$$\n(12 - 25)\n简化后得到\n$$\n\\sqrt{{I}_{11}} + \\sqrt{{I}_{12}} = 2\\sqrt{{I}_{\\mathrm{Q}}} \\tag{12 - 26}\n$$\n式中 ${I}_{11}$ 和 ${I}_{12}$ 的临界值为 $4{I}_{\\mathrm{Q}}$ ,当其中一个电流大于 $4{I}_{\\mathrm{Q}}$ 时,则另一个电流为 0,此时上式对电流的约束关系不再起作用,从而实现 Class AB 控制中电流有下限而无上限的特性。输出级的静态电流为 ${I}_{\\mathrm{O}} = C \\times  {I}_{\\mathrm{Q}}$ 。很明显,当一个输出晶体管的电流增加时,导致另一个晶体管电流减小直至完全截止。对于此类截止型控制,当两个输出晶体管在饱和导通与截止之间发生切换时,需要花费一定的时间将输出晶体管的栅源电压充放电至所需要的值,由此影响输出级的动态失真。显然,这种截止型控制不能满足以上 Class AB 静态点偏置要求中的第二条。因此,为了降低输出级的失真,一般希望采用无截止的 Class AB 控制。\n图 12-17 给出了一种无截止型 Class AB 控制电路, ${\\mathrm{M}}_{3}/{\\mathrm{M}}_{4}$ 管的源端为控制电路的输出 ${V}_{\\mathrm{C}}$ ,同样被反馈电路设定在 ${V}_{\\text{ref }}$ 点,同时控制结构中的 ${\\mathrm{M}}_{6}$ 管支路电流被设置在固定的 ${I}_{\\mathrm{m}}$ 下。与截止型相比,无截止型控制结构中 ${V}_{\\text{ref }}$ 电压分别控制 ${\\mathrm{M}}_{3}/{\\mathrm{M}}_{1}$ 以及 ${\\mathrm{M}}_{4}/{\\mathrm{M}}_{2}$ 支路中的过驱动电压。从定性的角度,当 ${I}_{12}$ 感应的输出电流很大时, ${\\mathrm{M}}_{4}$ 的栅电位被抬高到使其截止, ${I}_{\\mathrm{m}}$ 电流全部流过 ${\\mathrm{M}}_{3}$ 管。由于控制电路中所有晶体管的增益因子 $k$ 均相等,则 ${\\mathrm{M}}_{3}$ 与 ${\\mathrm{M}}_{5}$ 在流过相同电流条件下具有相同的过驱动电压。由于 ${\\mathrm{M}}_{6}/{\\mathrm{M}}_{5}$ 与 ${\\mathrm{M}}_{3}/{\\mathrm{M}}_{1}$ 两支路的过驱动电压总和相同,则 ${\\mathrm{M}}_{1}$ 与 ${\\mathrm{M}}_{6}$ 也具有相同的过驱动电压,从而避免 ${\\mathrm{M}}_{1}$ 进入截止区,最小电流为 ${I}_{\\mathrm{m}}$ 。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_361_230_940_1121_377_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_361_230_940_1121_377_0.jpg)\n图 12-17 无截止型 Class AB 控制电路\n设 ${I}_{11}$ 和 ${I}_{12}$ 与输出晶体管中流过电流的比例系数仍为 $C$ 。 ${I}_{3}$ 、 ${I}_{4}$ 为控制电路中 ${\\mathrm{M}}_{3}$ 、 ${\\mathrm{M}}_{4}$ 的电流。根据 ${M}_{1}$ 、 ${M}_{3}$ 、 ${M}_{5}$ 、 ${M}_{6}$ 环路以及 ${M}_{2}$ 、 ${M}_{4}$ 、 ${M}_{5}$ 、 ${M}_{6}$ 环路的 ${TL}$ 传输特性,可分别给出各环路电流满足的方程, 即\n$$\n\\left\\{  \\begin{array}{l} \\sqrt{{I}_{3}} = 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{11}} \\\\  \\sqrt{{I}_{4}} = 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{12}} \\end{array}\\right.  \\tag{12 - 27}\n$$\n由于 ${I}_{3}$ 和 ${I}_{4}$ 电流之和 ${I}_{\\mathrm{m}}$ 为常数,得\n$$\n{\\left( 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{11}}\\right) }^{2} + {\\left( 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{12}}\\right) }^{2} = {I}_{\\mathrm{m}} \\tag{12 - 28}\n$$\n输出级的静态电流 ${I}_{\\mathrm{O}} = C{I}_{{11}\\mathrm{Q}} = C{I}_{{12}\\mathrm{Q}}$ ,即由 ${I}_{{11}\\mathrm{Q}} = {I}_{{12}\\mathrm{Q}} < 4{I}_{\\mathrm{m}}$ 的条件,由上式解出\n$$\n{I}_{\\mathrm{O}} = \\frac{9 - 4\\sqrt{2}}{2}C{I}_{\\mathrm{m}} \\approx  {1.67C}{I}_{\\mathrm{m}} \\tag{12 - 29}\n$$\n当 ${I}_{11}$ 达到 $4{I}_{\\mathrm{m}}$ 时, ${I}_{12}$ 降到最小的 ${I}_{\\mathrm{m}}$ ; 同样,当 ${I}_{12} = 4{I}_{\\mathrm{m}}$ 时, ${I}_{11}$ 降到最小的 ${I}_{\\mathrm{m}}$ 。当 ${I}_{11}$ 或 ${I}_{12}$ 的值大于 $4{I}_{\\mathrm{m}},{\\mathrm{M}}_{3}$ 或 ${\\mathrm{M}}_{4}$ 截止,另一个电流 ${I}_{12}$ 或 ${I}_{11}$ 维持最小电流 ${I}_{\\mathrm{m}}$ 。此后,当其中一个输出晶体管的电流超出 ${4C}{I}_{\\mathrm{m}}$ 时,另一个晶体管的电流不会为零,输出晶体管的最小电流为 $C{I}_{\\mathrm{m}}$ 。\n图 12-17(a) 电路的电源电压至少应大于 NMOS、PMOS 阈值电压之和并加上 3 倍的饱和电压。为进一步降低电源电压,保持基本的控制原理不变,图 12-17(b) 中用电阻代替 MOS 二极管的改进控制结构,有效地降低了所需要的最小电源电压。 ${\\mathrm{M}}_{3}\\text{、}{\\mathrm{M}}_{4}\\text{、}{\\mathrm{M}}_{6}$ 的跨导参数相同并均为 $k$ ,采用相同的分析方法得到\n$$\n\\frac{k}{2}{\\left( {I}_{\\mathrm{m}}{R}_{5} + \\sqrt{\\frac{2{I}_{\\mathrm{m}}}{k}} - {I}_{11}{R}_{1}\\right) }^{2} + \\frac{k}{2}{\\left( {I}_{\\mathrm{m}}{R}_{5} + \\sqrt{\\frac{2{I}_{\\mathrm{m}}}{k}} - {I}_{12}{R}_{2}\\right) }^{2} = {I}_{\\mathrm{m}} \\tag{12 - 30}\n$$\n针对原有 MOS 二极管 $k$ 因子的匹配型设计,取 ${R}_{5} = {R}_{1} = {R}_{2} = R$ 的电阻匹配设计,且静态条件下由 ${I}_{{11}\\mathrm{Q}} = {I}_{{12}\\mathrm{Q}} = {I}_{\\mathrm{O}}/C$ 的条件,由上式得\n$$\n{I}_{\\mathrm{m}} + \\frac{1}{R}\\sqrt{\\frac{2{I}_{\\mathrm{m}}}{k}} - \\frac{{I}_{\\mathrm{O}}}{C} = \\frac{1}{R}\\sqrt{\\frac{{I}_{\\mathrm{m}}}{k}} \\tag{12 - 31}\n$$\n从上式解出的输出管静态电流为\n$$\n{I}_{\\mathrm{O}} = C\\left( {{I}_{\\mathrm{m}} + \\frac{1}{R}\\sqrt{\\frac{2{I}_{\\mathrm{m}}}{k}} - \\frac{1}{R}\\sqrt{\\frac{{I}_{\\mathrm{m}}}{k}}}\\right)  = C\\left( {{I}_{\\mathrm{m}} + \\frac{\\sqrt{2} - 1}{R}\\sqrt{\\frac{{I}_{\\mathrm{m}}}{k}}}\\right)  \\tag{12 - 32}\n$$\n同样,在很大的 $k$ 值和电阻 $R$ 下由上式计算得到的晶体管最小电流近似为 $C{I}_{\\mathrm{m}}$ 。由于相同大小的电流在电阻上的压降可以远小于 $\\mathrm{{MOS}}$ 晶体管的 ${\\mathrm{V}}_{\\mathrm{{GS}}}$ 压降,电源电压的低压要求得到满足。将图 12-17 所示的控制结构代入到图 12-15 的原型结构中,并用参考电流 ${I}_{\\mathrm{m}}$ 经 NMOS、PMOS 两个二极管的电压转换形成原始参考电压 ${V}_{\\text{ref }}$ ,由此得到一类完整的无截止型 Class AB 输出级驱动电路。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_362_408_1280_748_453_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_362_408_1280_748_453_0.jpg)\n图 12-18 最小电流选择型 Class AB 偏置输出级\n进一步地通过巧妙合并相关控制结构, 图 12-18 给出了一种结构简单、紧凑的最小电流选择反馈型 Class $\\mathrm{{AB}}$ 输出级电路, ${\\mathrm{M}}_{3} - {\\mathrm{M}}_{6}$ 构成了一个最小电流选择电路。 ${\\mathrm{M}}_{3}$ 通过 ${\\mathrm{M}}_{4}$ 感应流过 ${\\mathrm{M}}_{2}$ 的电流, ${\\mathrm{M}}_{6}$ 的栅极与 ${\\mathrm{M}}_{1}$ 的栅极相连,在 ${\\mathrm{M}}_{5}$ 进入深度线性区的条件下, ${\\mathrm{M}}_{6}$ 感应输出管 ${\\mathrm{M}}_{1}$ 中的电流。当输出级在静态点状态下, ${\\mathrm{M}}_{6}$ 的栅极电压与 ${V}_{\\mathrm{{CC}}}$ 的差值,即 ${\\mathrm{M}}_{1}$ 的栅源电压为\n$$\n{V}_{\\mathrm{{CC}}} - {V}_{\\mathrm{G}6} = {V}_{\\mathrm{{TP}}} + \\sqrt{2{I}_{1}/{k}_{1}} \\tag{12 - 33}\n$$\n而 ${\\mathrm{M}}_{5}$ 的栅源电压为\n$$\n{V}_{\\mathrm{{SGM5}}} = {V}_{\\mathrm{{TP}}} + \\sqrt{2{I}_{3}/{k}_{3}} = {V}_{\\mathrm{{TP}}} + \\sqrt{\\frac{2{I}_{2}{k}_{4}}{{k}_{2}}\\frac{1}{{k}_{3}}} \\tag{12 - 34}\n$$\n式中, ${I}_{\\mathrm{i}}$ 、 ${k}_{\\mathrm{i}}$ 为 ${\\mathrm{M}}_{\\mathrm{i}}$ 管的电流和增益因子。\n在静态工作状态下,由于 ${I}_{1} = {I}_{2}$ ,则有 ${I}_{3}/{I}_{1} = {I}_{4}/{I}_{2} = {k}_{4}/{k}_{2} = C$ 。设计中若取 ${k}_{3}/{k}_{1}$ $= C$ ,则过驱动电压 ${\\Delta }_{3} = {\\Delta }_{1}$ ,即 ${\\mathrm{M}}_{3}\\text{、}{\\mathrm{M}}_{5}$ 和 ${\\mathrm{M}}_{6}$ 的栅极电位相等,迫使 ${\\mathrm{M}}_{5}$ 管工作于线性电阻区, ${\\mathrm{M}}_{5}$ 和 ${\\mathrm{M}}_{6}$ 可以视为一个等效晶体管。如果 ${\\mathrm{M}}_{3}$ 、 ${\\mathrm{M}}_{5}$ 、 ${\\mathrm{M}}_{6}$ 这 3 个晶体管尺寸完全相同, ${\\mathrm{M}}_{5}/{\\mathrm{M}}_{6}$ 等效管的 $W/L$ 降低 $1/2$ ,则输出级的静态电流为\n$$\n{I}_{\\mathrm{O}} = \\frac{{k}_{10}}{{k}_{9}}{I}_{\\mathrm{Q}}\\frac{{k}_{3}}{{k}_{5,\\text{ 6eff }}}\\frac{{k}_{1}}{{k}_{3}} = {I}_{\\mathrm{Q}}\\frac{{k}_{3}}{{k}_{6}/2}\\frac{{k}_{1}}{{k}_{3}} = 2\\frac{{\\left( W/L\\right) }_{2}}{{\\left( W/L\\right) }_{4}}{I}_{\\mathrm{Q}} = {2C}{I}_{\\mathrm{Q}} \\tag{12 - 35}\n$$\n当 ${\\mathrm{M}}_{1}$ 驱动输出大电流时,其栅源电压增大,此时 ${\\mathrm{M}}_{6}$ 的源端和 ${V}_{\\mathrm{{CC}}}$ 之间有足够的电压空间,使 ${\\mathrm{M}}_{5}$ 管进入饱和工作区并感应 ${\\mathrm{M}}_{9}$ 电流 ${I}_{\\mathrm{Q}}$ ,同时, ${I}_{5} = {I}_{3} = {I}_{4} = {I}_{2}/C$ ,即 ${\\mathrm{M}}_{9}$ 的电流为 ${\\mathrm{M}}_{2}$ 的镜像电流。由于 ${I}_{5} = {I}_{9} = {I}_{\\mathrm{Q}}$ ,则 ${\\mathrm{M}}_{2}$ 的电流就固定为 $C{I}_{\\mathrm{Q}}$ ,即当 ${I}_{1}$ 很大时,迫使 ${\\mathrm{M}}_{2}$ 降低到最低的 ${I}_{2\\mathrm{{min}}} = C{I}_{\\mathrm{Q}}$ 状态。\n同样, ${\\mathrm{M}}_{2}$ 驱动大电流时,经 ${\\mathrm{M}}_{4}/{\\mathrm{M}}_{3}$ 的电流转换后, ${\\mathrm{M}}_{5}$ 的高栅源电压使其进入深度线性区, ${V}_{\\mathrm{d}{s5}}$ 电压降低到可以忽略,在 ${\\mathrm{M}}_{6}$ 的源端接近于 ${V}_{\\mathrm{{CC}}}$ 。这时 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{6}$ 构成线性电流镜, ${\\mathrm{M}}_{1}$ 的电流受到 ${I}_{\\mathrm{Q}}$ 控制,经线性放大后同样固定在 $C{I}_{\\mathrm{Q}}$ 附近,即当 ${I}_{2}$ 很大时, ${\\mathrm{M}}_{1}$ 被强制降到最低的 ${I}_{1\\min } = C{I}_{\\mathrm{Q}}$ 状态。\n显然,这是一个基于最小电流选择的 Class AB 控制电路,其基本思想是将 ${I}_{\\mathrm{Q}}$ 电流通过反馈环路中的差分运放传输到 ${\\mathrm{M}}_{6}$ 、 ${\\mathrm{M}}_{5}$ 管中,并根据电路状态,可由 ${\\mathrm{M}}_{6}$ 比例传输到 ${\\mathrm{M}}_{1}$ 获得最小电流,或由 ${\\mathrm{M}}_{5}$ 管经 ${\\mathrm{M}}_{3}/{\\mathrm{M}}_{4}$ 的转换再比例传输到 ${\\mathrm{M}}_{2}$ 中获得最小电流。当输出管中的一个为最小电流时,另一个则接近最大电流,静态电流为最小输出电流的两倍。\n## 2)反馈环路的稳定性\n反馈控制电路所需要的参考电压 ${V}_{\\text{ref }}$ 没有直接驱动输出级的主要原因,在于控制电路在动态调节过程中因对参考支路的分流作用,将导致参考电压的改变。为此,采用一全差分运放进行隔离,利用该辅助运放的电压调节作用,提供控制电路所需的稳定 ${V}_{\\text{ref }}$ 值。辅助运放的差分输出分别接入输出级的栅控信号,运放的引入以不影响前级输出为准则,其负载偏置以相同的电流 ${I}_{\\text{ref }}$ 并分别流过差分控制对管,确保其调制作用在 Class AB 的整个动态范围内都有效。\n这样,反馈控制电路与差分运放调节电路构成整个 Class AB 反馈控制环路,在满足 Class AB输出电流驱动控制功能的前提下,需要提高反馈环路的响应速度,而瞬态特性则受反馈环路稳定性的严重制约。\n为了得到 Class AB 控制环路的传输函数, 首先将反馈环路在差分控制对管反馈到栅极的位置处与控制电路模块输出 ${V}_{\\mathrm{C}}$ 处断开。在计算控制环路的传输函数时,应该将主运放输出 ${V}_{\\mathrm{{OUT}}}$ 节点视为接地,因为运放整体应用的要求决定了输出电压只对运放输入信号响应, 而稳态下不对内部控制信号响应。环路增益由控制环节和差分调节环节两部分组成, 因此 Class AB 环路可以认为是一个两级放大器。以图 12-15 的基本原型结构为例, ${\\mathrm{M}}_{6}$ 是第一级放大,由于输出级密勒电容 ${C}_{\\mathrm{m}1}$ 和 ${C}_{\\mathrm{m}2}$ 的频率补偿,该补偿电容成为第一级的负载电容。 ${\\mathrm{M}}_{6}$ 和 ${\\mathrm{M}}_{5}$ 的输出构成 ${\\mathrm{M}}_{3}$ 、 ${\\mathrm{M}}_{4}$ 第二级增益的输入驱动信号。通常,控制电路小信号输出电流的期望值为\n$$\n{i}_{\\text{out }} = {m}_{1}{i}_{11} + {m}_{2}{i}_{12} \\tag{12 - 36}\n$$\n式中: ${i}_{\\text{out }}$ ——控制电路输出的小信号电流;\n${i}_{11}$ 、 ${i}_{12}$ —— ${\\mathrm{M}}_{3}$ 、 ${\\mathrm{M}}_{4}$ 管感应出系统输出的小信号变化电流；\n${m}_{1}$ 、 ${m}_{2}$ ——电流转换的比例系数,决定于 Class AB 的控制关系；\n设 ${g}_{\\mathrm{m}5,6}$ 为 ${\\mathrm{M}}_{5}$ 、 ${\\mathrm{M}}_{6}$ 差分对管的匹配跨导, ${g}_{\\mathrm{m}3,\\mathrm{{out}}}$ 、 ${g}_{\\mathrm{m}4,\\mathrm{{out}}}$ 为环路中输出电流感应管 ${\\mathrm{M}}_{3}$ 、 ${\\mathrm{M}}_{4}$ 两管跨导。仅考虑 ${\\mathrm{M}}_{6}$ 管的单支路反馈控制,两级 Class AB 控制环路的低频直流增益为 ${A}_{\\mathrm{{VCA}}} = {g}_{\\mathrm{m}6}{r}_{\\mathrm{A}}{g}_{\\mathrm{m}4}{r}_{\\mathrm{{out}}}$ ,控制环路的主极点位于第一级输出, ${p}_{-3\\mathrm{{dbA}}} = 1/\\left( {{r}_{\\mathrm{A}}{C}_{\\mathrm{m}2}}\\right)$ ,则其增益带宽积 ${\\mathrm{{GBW}}}_{\\mathrm{A}} = {A}_{\\mathrm{{VCA}}}{p}_{-3\\mathrm{{dbA}}} = {g}_{\\mathrm{m}6}{r}_{\\mathrm{{out}}}{g}_{\\mathrm{m}4}/{C}_{\\mathrm{m}2}$ ; 同样,另一支路 ${\\mathrm{{GBW}}}_{\\mathrm{B}} = {A}_{\\mathrm{{VCB}}}{p}_{-3\\mathrm{{dBB}}} =$ ${g}_{\\mathrm{m}5}{r}_{\\mathrm{{out}}{g}_{\\mathrm{m}3}}/{C}_{\\mathrm{m}1}$ 。由于两并联控制支路的分流系数 ${m}_{1}$ 和 ${m}_{2}$ 随 Class AB 状态点的改变并共同起作用,则控制环路总的单位增益带宽为\n$$\n{\\mathrm{{GBW}}}_{\\mathrm{{AB}}} = {g}_{\\mathrm{m}5,6}{r}_{\\mathrm{{out}}}\\left( {\\frac{{m}_{1}{g}_{\\mathrm{m}3,\\mathrm{{out}}}}{{C}_{\\mathrm{{m1}}}} + \\frac{{m}_{2}{g}_{\\mathrm{m}4,\\mathrm{{out}}}}{{C}_{\\mathrm{m}2}}}\\right)  \\tag{12 - 37}\n$$\n根据以上原理分析,可计算得到不同的电流分配系数 $m$ 对控制环路带宽的影响。对于截止型 Class AB 控制结构,由其线性电压控制电路结构,根据式 (12-16) 所示的静态电流与感应电流的关系, 输出电流为\n$$\n{i}_{\\text{out }} = \\frac{1}{4}{\\left( \\sqrt{{I}_{12}} + \\sqrt{{I}_{11}}\\right) }^{2} - {I}_{\\mathrm{Q}} \\tag{12 - 38}\n$$\n平衡条件下的输出控制电流 ${i}_{\\text{out }} = 0$ ,且 ${I}_{11}\\text{、}{I}_{12}$ 均为固定常数。而在非平衡动态条件下, ${I}_{11}$ 和 ${I}_{12}$ 的交流小信号变化量为 ${i}_{11}$ 和 ${i}_{12}$ ,则输出电流与感应控制电流的关系为\n$$\n{i}_{\\text{out }} = \\frac{\\partial {i}_{\\text{out }}}{\\partial {I}_{11}}{i}_{11} + \\frac{\\partial {i}_{\\text{out }}}{\\partial {I}_{12}}{i}_{12} = \\frac{1}{4}\\left( {1 + \\sqrt{\\frac{{I}_{12}}{{I}_{11}}}}\\right) {i}_{11} + \\frac{1}{4}\\left( {1 + \\sqrt{\\frac{{I}_{11}}{{I}_{12}}}}\\right) {i}_{12} \\tag{12 - 39}\n$$\n对照公式 (12-36), 可以发现\n$$\n\\left. \\begin{array}{l} {m}_{1} = \\frac{1}{4}\\left( {1 + \\sqrt{\\frac{{I}_{12}}{{I}_{11}}}}\\right) \\\\  {m}_{2} = \\frac{1}{4}\\left( {1 + \\sqrt{\\frac{{I}_{11}}{{I}_{12}}}}\\right)  \\end{array}\\right\\}   \\tag{12 - 40}\n$$\n由 ${g}_{\\mathrm{m}3,\\text{ out }} = {\\left( 2k{I}_{11}\\right) }^{1/2}\\text{、}{g}_{\\mathrm{{mt}},\\text{ out }} = {\\left( 2k{I}_{12}\\right) }^{1/2}$ 的条件,其中 $k$ 为电流感应管 ${\\mathrm{M}}_{3}\\text{、}{\\mathrm{M}}_{4}$ 的跨导参数,并将上式代入式(12 - 37)后,可得\n$$\n{\\mathrm{{GBW}}}_{\\mathrm{{AB}}} = \\frac{1}{4}{g}_{\\mathrm{m}{5.6}}{r}_{\\text{out }}\\sqrt{2k}\\left( {\\sqrt{{I}_{11}} + \\sqrt{{I}_{12}}}\\right) \\left( {\\frac{1}{{C}_{\\mathrm{m}1}} + \\frac{1}{{C}_{\\mathrm{m}2}}}\\right)  \\tag{12 - 41}\n$$\n为了减小失真,一般将两个密勒电容 ${C}_{\\mathrm{m}1}$ 和 ${C}_{\\mathrm{m}2}$ 的值设定为相等的 ${C}_{\\mathrm{m}}$ 值。同时代入 ${I}_{11}$ 、 ${I}_{12}$ 电流所满足的平衡条件,化简得\n$$\n{\\mathrm{{GBW}}}_{\\mathrm{{AB}}} = \\frac{{g}_{\\mathrm{m}5,6}{r}_{\\text{out }}\\sqrt{{2k}{I}_{\\mathrm{Q}}}}{{C}_{\\mathrm{m}}} \\tag{12 - 42}\n$$\n以上带宽中没有出现输出电流, 因此简单线性电压控制型环路的增益带宽积具有线性性质。若控制环路 ${\\mathrm{{GBW}}}_{\\mathrm{{AB}}}$ 频率下满足相位裕度并同时大于主运放系统单位增益带宽的要求,可使输出晶体管在高速动态驱动过程中也可保持稳定。\n用相同方法分析无截止型 Class AB 控制环路,根据式(12-17)所示平衡条件下的电流关系, 可以得到非平衡动态小信号状态下的输出电流为\n$$\n{i}_{\\text{out }} = {I}_{\\mathrm{m}} - \\left( {{i}_{3} + {i}_{4}}\\right)  = {I}_{\\mathrm{m}} - {\\left( 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{11}}\\right) }^{2} - {\\left( 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{12}}\\right) }^{2} \\tag{12 - 43}\n$$\n平衡条件下 ${i}_{\\text{out }} = 0$ ,采用小信号偏导方法,得到小信号输出电流包含两控制分量的贡献为\n$$\n{i}_{\\text{out }} = \\left( {2\\sqrt{\\frac{{I}_{\\mathrm{m}}}{{I}_{11}}} - 1}\\right) {i}_{11} + \\left( {2\\sqrt{\\frac{{I}_{\\mathrm{m}}}{{I}_{12}}} - 1}\\right) {i}_{12} \\tag{12 - 44}\n$$\n则 Class AB 中电流传输的比例系数为\n$$\n\\left. \\begin{array}{l} {m}_{1} = 2\\sqrt{\\frac{{I}_{\\mathrm{m}}}{{I}_{11}}} - 1 \\\\  {m}_{2} = 2\\sqrt{\\frac{{I}_{\\mathrm{m}}}{{I}_{12}}} - 1 \\end{array}\\right\\}   \\tag{12 - 45}\n$$\n在 ${C}_{\\mathrm{m}1} = {C}_{\\mathrm{m}2} = {C}_{\\mathrm{m}}$ 条件下,增益带宽积为\n$$\n{\\mathrm{{GBW}}}_{\\mathrm{{AB}}} = \\frac{{g}_{\\mathrm{m}5,6}{r}_{\\text{out }}}{{C}_{\\mathrm{m}}}\\sqrt{2k}\\left\\lbrack  {\\left( {2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{11}}}\\right)  + \\left( {2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{12}}}\\right) }\\right\\rbrack   \\tag{12 - 46}\n$$\n在 ${I}_{11}$ 和 ${I}_{12}$ 的平衡条件下,对于无截止型的 ${I}_{11}\\text{、}{I}_{12}$ 电流, ${I}_{11}/{I}_{\\mathrm{m}}$ 与 ${I}_{12}/{I}_{\\mathrm{m}}$ 的最小值为 1, 当其中一路电流为 1 时,则另一路归一化电流为 4 ,由式 (12-28) 可得\n$$\n\\left. \\begin{array}{l} {\\left( 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{12}}\\right) }^{2} = {\\left( \\sqrt{1 - \\alpha }\\sqrt{{I}_{\\mathrm{m}}}\\right) }^{2} \\\\  {\\left( 2\\sqrt{{I}_{\\mathrm{m}}} - \\sqrt{{I}_{11}}\\right) }^{2} = {\\left( \\sqrt{\\alpha }\\sqrt{{I}_{\\mathrm{m}}}\\right) }^{2} \\end{array}\\right\\}   \\tag{12 - 47}\n$$\n式中参变量 ${\\left( \\alpha \\right) }^{1/2} = 2 - {\\left( {I}_{11}/{I}_{\\mathrm{m}}\\right) }^{1/2}$ ,当 ${\\left( 1 - \\alpha \\right) }^{1/2} = 2 - {\\left( {I}_{12}/{I}_{\\mathrm{m}}\\right) }^{1/2},\\alpha$ 随 Class AB 的输出驱动电流而变化, $0 \\leq  \\alpha  \\leq  1$ ,由上式可得\n$$\n4\\sqrt{{I}_{\\mathrm{m}}} - \\left( {\\sqrt{{I}_{11}} + \\sqrt{{I}_{12}}}\\right)  = \\left( {\\sqrt{\\alpha } + \\sqrt{1 - \\alpha }}\\right) \\sqrt{{I}_{\\mathrm{m}}} = \\beta \\sqrt{{I}_{\\mathrm{m}}} \\tag{12 - 48}\n$$\n式中参变量 $\\beta  = {\\left( \\alpha \\right) }^{1/2} + {\\left( 1 - \\alpha \\right) }^{1/2},\\alpha$ 的变化导致 $\\beta$ 出现极值, $\\beta$ 最大值发生的条件为 $\\alpha  =$ $1/2$ ,即对应于静态工作点状态, ${\\beta }_{\\max } = {2}^{1/2},\\beta$ 的最小值发生在 $\\alpha  = 0$ 或 $\\alpha  = 1$ 的两个端点, 对应于最大的上拉或下拉驱动,即 ${\\beta }_{\\min } = 1$ 。因此,参数 $\\beta$ 也是与 Class AB 输出驱动电流状态相关的参变量,变化范围为 $1 \\leq  \\beta  \\leq  {2}^{1/2}$ 。将上式代入 $\\mathrm{{GBW}}$ 的表达式后,可得控制环路的带宽为\n$$\n{\\mathrm{{GBW}}}_{\\mathrm{{AB}}} = \\frac{{g}_{\\mathrm{m}5,6}{r}_{\\mathrm{{out}}}\\beta \\sqrt{{2k}{I}_{\\mathrm{m}}}}{{C}_{\\mathrm{m}}} \\tag{12 - 49}\n$$\n显然,在最大的负载驱动下,由于 ${\\beta }_{\\mathrm{m}} = 1$ ,则控制环路带宽降为最小的 ${\\mathrm{{GBW}}}_{\\mathrm{{AB}}\\min }$ ,并与线性电压控制环路的单位增益积相似; 而在静态工作点的空载驱动下, 控制环路带宽达到最大的 ${\\mathrm{{GBW}}}_{\\mathrm{{AB}}\\max }$ 。但控制环路带宽的最大与最小值变化不到 ${50}\\%$ ,可近似认为不受输出负载电流的影响。\n最小电流选择型 Class AB 与以上非截止型结构具有相同的环路带宽性质,但由于最小电流选择型结构中的大电流输出没有上限限制, 则其环路带宽明显随系统输出电流的变化而改变。\n通过以上分析可以发现,当 Class AB 控制电路中采用恒定参考电流时,控制环路增益带宽积与输出电流大小无关或近似无关。但也有例外, 当控制电路中电流感应采用自适应控制时,如在最小电流选择控制环路结构中,控制环路的增益带宽积就与输出电流有关。当 ${\\mathrm{{GBW}}}_{\\mathrm{{AB}}}$ 随负载电流大幅度变化时,将导致系统稳定性设计的复杂化。通常,最大电流驱动下所对应的最低环路带宽应满足大于主运放系统带宽的最低要求。\n整个运放系统的稳定性对环路增益带宽积提出了具体要求。首先, 控制环路本身必须稳定, 这是系统稳定控制的前提, 即控制环路增益带宽积必须小于该环路中所有非主极点; 其次,考虑环路带宽和整个运放带宽之间的相互关系,即 Class AB 控制环路必须在系统工作的所有频率下都能正确偏置输出晶体管,因此控制环路的带宽必须至少高于主运放的带宽。\n以图 12-15 的基本结构为例,控制环路通常为两级放大器,主极点位于 ${\\mathrm{M}}_{3}$ 和 ${\\mathrm{M}}_{4}$ 的栅极,而另外一个非主极点在 ${\\mathrm{M}}_{6}$ 的栅极, ${r}_{\\text{out }}$ 是控制模块的输出电阻, ${C}_{\\mathrm{m}6}$ 是 ${\\mathrm{M}}_{6}$ 栅极的寄生电容。设 $\\mathrm{{GBW}}$ 是整个运放的增益带宽积。当控制环路的相位裕量为 ${60}^{ \\circ  }$ ,同时主运放稳定时, 则环路带宽需要满足的条件为\n$$\n\\mathrm{{GBW}} < {\\mathrm{{GBW}}}_{\\mathrm{{AB}}} \\leq  \\frac{1}{2}{p}_{2} = \\frac{1}{2{r}_{\\mathrm{{out}}}{C}_{\\mathrm{m}6}} \\tag{12 - 50}\n$$\n显然,环路带宽 ${\\mathrm{{GBW}}}_{\\mathrm{{AB}}}$ 由环路中存在的非主极点决定,而主运放的带宽又由控制环路的带宽 ${\\mathrm{{GBW}}}_{\\mathrm{{AB}}}$ 决定。不同的 Class $\\mathrm{{AB}}$ 控制结构,环路中非主极点的数目也不尽相同。如果非主极点的数目增多, Class AB 控制环路的增益带宽积将进一步减小,从而限制了主运放带宽的提高。因此,反馈型 Class AB 运放的带宽不仅受到信号主通道上的非主极点限制, 而且还要受到控制环路次极点的制约。由此可以看出, 即使通过良好的调节,反馈型 Class AB 运放输出级的频带也不可能很宽,这种运放无法处理频率较高的信号。\n在简单的环路控制结构中, 控制器的输出直接连接参考支路, 因此在动态调节过程中产生相互作用,影响控制精度。图 12-19 给出的两种反馈型 Class AB 运放输出级的完整电路结构中,与前文讨论的基本控制结构相比,控制电路的输出经过了内置差分运放的隔离。 通过运放对控制输出的隔离, 控制输出与参考基准分别接起隔离调节作用的运放两差分输入端, 在静态条件下利用运放的虚短性质, 其作用完全等效于静态条件下的基本环路控制作用,而在动态调节过程中又能避免对参考支路的影响。\n反馈型环路控制下的 Class AB 作为单纯的输出级, 结构复杂。直观上, 正是由于反馈型 Class AB 输出级电路的复杂性才导致其频率特性的相对不足。因此,当反馈环路速度固定时,就需要牺牲运放系统的响应速度来获得系统工作的稳定。与此相对应,前馈\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_367_344_258_895_1008_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_367_344_258_895_1008_0.jpg)\n图 12-19 无截止 Class AB 输出级电路结构\n控制结构则在提高 Class AB 输出级的频率与瞬态响应性能方面提供了一条新的有效技术路径。\n#### 12.4.3 前馈型 Class AB偏置技术\n比较前馈与反馈控制结构的差别可以清楚看出,反馈型 Class AB 输出级一般需要两个输入信号, 即静态工作点不同的同相信号。由于电路的前级输出通常只有一个信号, 或者一对反相信号,这就要求在反馈型 Class AB 输出级之前增加一个额外的电路以获得两个静态点不同的同相信号。这不但增加了电路的复杂性, 而且由于级数的增加导致频率特性的明显退化。前馈型 Class AB 输出级则与此不同,其结构简单,通常只需要一个输出信号,并通过固定的电平移位实现对输出互补功率管的驱动, 没有内部的反馈控制调节, 因此响应速度快。\n互补型共源 Class AB 输出级前馈控制原型结构如图 12-20(a) 所示。若输出管 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{2}$ 饱和恒流区下的跨导参数相等并设为 $k$ ,由图可以得到如下关系:\n$$\n{V}_{\\text{refl }} + {V}_{\\text{ref }2} - {V}_{\\mathrm{D}1} - {V}_{\\mathrm{D}2} = {V}_{\\mathrm{{CC}}} - \\left( {{V}_{\\mathrm{{TP}}} + \\sqrt{\\frac{2{I}_{1}}{k}} + {V}_{\\mathrm{{TN}}} + \\sqrt{\\frac{2{I}_{2}}{k}}}\\right)  \\tag{12 - 51}\n$$\n式中, ${\\mathrm{V}}_{\\mathrm{{D1}}}$ 、 ${\\mathrm{V}}_{\\mathrm{{D2}}}$ 为两个电平移位二极管 ${\\mathrm{D}}_{1}$ 和 ${\\mathrm{D}}_{2}$ 上的导通压降。\n上式经变化后得\n$$\n\\sqrt{{I}_{1}} + \\sqrt{{I}_{2}} = \\sqrt{k/2} \\cdot  \\left\\lbrack  {{V}_{\\mathrm{{CC}}} - \\left( {{V}_{\\text{refl }} + {V}_{\\text{ref2 }}}\\right)  + {V}_{\\mathrm{{D1}}} + {V}_{\\mathrm{{D2}}} - {V}_{\\mathrm{{TP}}} - {V}_{\\mathrm{{TN}}}}\\right\\rbrack  \\left( {{12} - {52}}\\right)  \\tag{12 - 52}\n$$\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_368_342_380_844_425_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_368_342_380_844_425_0.jpg)\n图 12-20 共源前馈型 Class AB 控制原理\n由于 ${\\mathrm{D}}_{1}\\text{、}{\\mathrm{D}}_{2}$ 流过的恒定电流 ${I}_{\\text{ref }}$ 使 ${V}_{\\mathrm{D}1}$ 和 ${V}_{\\mathrm{D}2}$ 固定,则上式右端为固定常数,静态下 ${I}_{1} =$ ${I}_{2}$ ,由此方便的实现对静态偏置电流的控制。而在动态条件下, ${I}_{1}$ 增加必然导致 ${I}_{2}$ 减小,这样就得到了 Class AB 输出特性。该结构中两个浮动电压源的设计相对困难。图12-20(b) 给出一种简化的结构设计,浮动电压源减少为一个。对比两种结构,简化结构中 ${V}_{\\text{ref }}$ 等效于 $\\left( {{\\mathrm{V}}_{\\text{refl }} + {\\mathrm{V}}_{\\text{rel }}}\\right)  - \\left( {{\\mathrm{V}}_{\\mathrm{{D1}}} + {\\mathrm{V}}_{\\mathrm{{D2}}}}\\right)$ 的作用,然而,以上控制前馈结构中输出管 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{2}$ 电流最小可降到零,这种截止型前馈控制同样限制了输出级瞬态响应速度的提高,同时增加了非线性失真,有必要加以适当改进。简化后的前馈控制结构同样可以获得 Class AB 驱动特性。\n## 1)截止前馈型 Class AB 输出控制结构\n根据以上原理,图 12-21 给出了一种简单前馈控制的 Class AB 输出级电路,其中 ${V}_{\\mathrm{{IN}}}$ 为输入信号,两个电阻和 4 个 MOS 晶体管构成了输出级 Class AB 控制单元。由于 ${\\mathrm{M}}_{3}$ 、 ${\\mathrm{M}}_{5}$ 和 ${\\mathrm{M}}_{4}$ 、 ${\\mathrm{M}}_{6}$ 分别构成两个电流镜,电阻 ${R}_{1}$ 和 ${R}_{2}$ 上流过相等的电流。设 ${I}_{1}$ 、 ${I}_{2}$ 分别为输出管 ${\\mathrm{M}}_{1}$ 、 ${\\mathrm{M}}_{2}$ 中的电流。若电阻 ${R}_{1}$ 和 ${R}_{2}$ 阻值相等并为 $R$ ,则当电源电压 ${V}_{\\mathrm{{CC}}}$ 固定时,由 ${R}_{2}$ 偏置电流 ${I}_{\\mathrm{R}} = {I}_{\\text{bias }}$ 可以求出两个电阻上的压降相同并均为 ${I}_{\\text{bias }}R$ ,即 ${V}_{\\mathrm{{GS5}}} + {V}_{\\mathrm{{GS6}}} = {V}_{\\mathrm{{GS1}}} + {V}_{\\mathrm{{GS2}}}$ 。 调整 MOS 晶体管的宽长比,使其满足 ${k}_{1} = {k}_{2} = C{k}_{5} = C{k}_{6} = {Ck}$ ,则有\n$$\n2\\sqrt{C{I}_{\\mathrm{R}}} = \\sqrt{{I}_{1}} + \\sqrt{{I}_{2}} \\tag{12 - 53}\n$$\n因此, 输出级晶体管静态输出电流的平方根和为常数, 则静态电流为\n$$\n{I}_{\\mathrm{O}} = {I}_{1} = {I}_{2} = C{I}_{\\mathrm{R}} = C\\frac{{V}_{\\mathrm{{CC}}} - {V}_{\\mathrm{{TN}}} - {V}_{\\mathrm{{TP}}} - {\\Delta }_{\\mathrm{N}} - {\\Delta }_{\\mathrm{P}}}{R} \\approx  C\\frac{{V}_{\\mathrm{{CC}}} - {V}_{\\mathrm{{TN}}} - {V}_{\\mathrm{{TP}}}}{R}\n$$\n(12 - 54)\n而在动态条件下, ${V}_{\\text{in }}$ 增加使 ${I}_{1}$ 下降时,由于 ${R}_{1}$ 的固定电平移位,则必然造成 ${I}_{2}$ 增加, 从而实现了 Class AB 驱动特性。当 ${I}_{1} = 0,{I}_{2} = {4C}{I}_{\\mathrm{R}}$ ,同样当 ${I}_{2} = 0,{I}_{1} = {4C}{I}_{\\mathrm{R}}$ 时,这就是一种截止型的前馈控制。因此,输出电流非截止时的信号动态范围为 $0 \\sim  {4C}{I}_{\\mathrm{R}}$ 。当 ${V}_{\\text{in }}$ 增加使一个驱动管截止后, 必然导致另一个驱动管的电流增加, 式 (12-53) 的约束不再成立, 最大驱动电流由驱动管进入线性区的条件决定。静态电流与最大驱动电流的关系决定了电路转换效率的水平,最大驱动电流可以达到静态电流的十几倍、几十倍甚至更高以提升电流效率, 但大信号驱动下由于截止管的存在使电路的非线性显著增加。此外, 输出级的总跨导为两输出管跨导之和,在整个工作区域内由于电流的不连续而导致两输出管跨导的不匹配, 造成总跨导在一定范围内的波动。\n与反馈环路增益一样,前馈通路同样存在小信号增益。前馈小信号增益分别定义为两输出晶体管栅极上的小信号幅度与输入信号幅度的比值。图 12-21 中,由于输入信号直接送入 ${\\mathrm{M}}_{1}$ 管的栅极,所以 ${\\mathrm{M}}_{1}$ 上的前馈小信号增益为 1,而 ${\\mathrm{M}}_{2}$ 管栅极小信号电压增益由阻抗分压比 ${r}_{\\mathrm{{ds4}}}/\\left( {{r}_{\\mathrm{{ds4}}} + R}\\right)$ 决定。由于 ${r}_{\\mathrm{{ds4}}} \\gg  R$ ,所以 ${\\mathrm{M}}_{2}$ 栅极上的小信号增益虽小于但却充分接近于 1 。前馈通路中两个小信号增益的充分接近,有利于减小信号放大的失真。\n前馈型控制电路在完成对输出级静态偏置点控制的条件下, 对主运放前级输出的影响应降到最低。以截止型前馈控制为例,从输入端 ${V}_{\\mathrm{{in}}}$ 看过去的输入电阻 ${r}_{\\mathrm{{in}}} = \\left( {R + {r}_{\\mathrm{{dst}}}}\\right) //$ ${r}_{\\mathrm{{ds}}3}$ ,由于 ${r}_{\\mathrm{{ds}}3}$ 、 ${r}_{\\mathrm{{ds}}4}$ 均为高阻,输入为高阻,对前级负载驱动特性的影响可以忽略。\n当然,前馈控制结构中由于采用 MOS 二极管与电阻 $R$ 的串联偏置,电流 ${I}_{\\mathrm{R}}$ 与电源电压关系密切,当 ${V}_{\\mathrm{{CC}}}$ 变化导致 ${I}_{\\mathrm{R}}$ 大范围变化时,引起输出级静态电流及输出驱动电流发生较大的变化,对系统性能和稳定性均产生不利影响。因此,基于电阻偏置的截止型前馈 Class $\\mathrm{{AB}}$ 控制电路比较适合电源电压固定的应用场合。\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_369_227_1069_435_415_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_369_227_1069_435_415_0.jpg)\n图 12-21 前馈截止型输出级电路\n![0196aaa2-bbe2-70ee-823d-d4abf5c67805_369_809_1042_552_440_0.jpg](images/0196aaa2-bbe2-70ee-823d-d4abf5c67805_369_809_1042_552_440_0.jpg)\n图 12-22 无截止前馈型输出电路\n## 2)无截止前馈型 Class AB 输出控制结构\n在反馈型 Class AB 控制电路的分析中已经提到,如果输出晶体管进入深度截止,将导致响应速度降低、输出级动态失真特性变差的不利影响。因此在前馈控制结构中,同样希望输出晶体管始终处于饱和或弱反型工作区。图 12-22 给出了一种输出管无截止的前馈型 Class AB输出控制电路。该控制电路由 ${\\mathrm{M}}_{3} - {\\mathrm{M}}_{8}$ 组成,设 ${k}_{\\mathrm{i}}\\text{、}{I}_{\\mathrm{i}}$ 分别为 ${\\mathrm{M}}_{\\mathrm{i}}$ 管的跨导参数与输出电流, $C$ 为输出管与内部控制管的比例系数,调整电路中晶体管的跨导参数 $k$ 满足 ${k}_{3} = {k}_{4} = {k}_{7} = {k}_{8} = k,{k}_{1} = {k}_{2} = {Ck},{k}_{5} = {k}_{6} = k$ 。该电路与第五章中介绍的一种 Class AB 电路完全相同,本章将在前馈控制的基础上深入分析该电路的特性。\n${\\mathrm{M}}_{7}$ 、 ${\\mathrm{M}}_{8}$ 、 ${\\mathrm{M}}_{6}$ 、 ${\\mathrm{M}}_{2}$ 四管构成一个 NMOS TL 控制环,同样 ${\\mathrm{M}}_{3}$ 、 ${\\mathrm{M}}_{4}$ 、 ${\\mathrm{M}}_{5}$ 、 ${\\mathrm{M}}_{1}$ 四管构成另一个 PMOS TL 控制环。根据此两 TL 环路性质, 分别得到\n$$\n\\left. \\begin{array}{l} \\sqrt{{I}_{6}} + \\sqrt{\\frac{{I}_{2}}{C}} = 2\\sqrt{{I}_{\\mathrm{Q}}} \\\\  \\sqrt{{I}_{5}} + \\sqrt{\\frac{{I}_{1}}{C}} = 2\\sqrt{{I}_{\\mathrm{Q}}} \\end{array}\\right\\}   \\tag{12 - 55}\n$$\n${\\mathrm{M}}_{5}$ 和 ${\\mathrm{M}}_{6}$ 电流之和为 $2{I}_{\\mathrm{Q}}$ ,所以\n$$\n{\\left( 2\\sqrt{{I}_{\\mathrm{Q}}} - \\sqrt{\\frac{{I}_{1}}{C}}\\right) }^{2} + {\\left( 2\\sqrt{{I}_{\\mathrm{Q}}} - \\sqrt{\\frac{{I}_{2}}{C}}\\right) }^{2} = 2{I}_{\\mathrm{Q}} \\tag{12 - 56}\n$$\n化简后得\n$$\n{\\left( 2\\sqrt{C{I}_{\\mathrm{Q}}} - \\sqrt{{I}_{1}}\\right) }^{2} + {\\left( 2\\sqrt{C{I}_{\\mathrm{Q}}} - \\sqrt{{I}_{2}}\\right) }^{2} = {2C}{I}_{\\mathrm{Q}} \\tag{12 - 57}\n$$\n该式与反馈控制结构中的式(12-28)形式相似。\n在静态工作点下, ${I}_{1} = {I}_{2} = {I}_{\\mathrm{O}}$ ,由此得到 ${I}_{\\mathrm{O}} = C{I}_{\\mathrm{Q}}$ 。在大负载驱动下,当某一输出管电流达到特定的临界点时, 使上式中某一项为零, 即\n$$\n\\left. \\begin{array}{l} 2\\sqrt{C{I}_{\\mathrm{Q}}} - \\sqrt{{I}_{1}} = 0 \\\\  {I}_{1,\\max } = {4C}{I}_{\\mathrm{Q}} \\end{array}\\right\\}   \\tag{12 - 58}\n$$\n由大负载电流所对应的最小输入电流满足\n$$\n\\left. \\begin{array}{l} 2\\sqrt{C{I}_{\\mathrm{Q}}} - \\sqrt{{I}_{2}} = \\sqrt{{2C}{I}_{\\mathrm{Q}}} \\\\  {I}_{2,\\min } = {\\left( 2 - \\sqrt{2}\\right) }^{2}C{I}_{\\mathrm{Q}} \\approx  {0.343C}{I}_{\\mathrm{Q}} \\end{array}\\right\\}   \\tag{12 - 59}\n$$\n同样,当 ${I}_{1\\min }$ 达到 ${0.343C}{I}_{\\mathrm{Q}} = {0.343}{I}_{\\mathrm{O}}$ 时, ${I}_{2\\max } = {4C}{I}_{\\mathrm{Q}} = 4{I}_{\\mathrm{O}}$ 。显然,在以上参数条件下,只要 $C$ 和 ${I}_{\\mathrm{Q}}$ 不过低,则该控制结构实现了无截止前馈型 Class AB 输出特性。根据 (12- 57)式,输出晶体管的最大电流为 $4{I}_{\\mathrm{O}}$ ,但实际电路的最大电流并不受此限制。假设输出晶体管 ${\\mathrm{M}}_{1}$ 输出大电流时, ${\\mathrm{M}}_{5}$ 截止后,以上 $\\mathrm{{TL}}$ 关系不再成立。由于 ${\\mathrm{M}}_{5}$ 截止,无电流通过,电流源 $2{I}_{\\mathrm{Q}}$ 的电流全部从 ${\\mathrm{M}}_{6}$ 管流过并保持不变,导致 ${\\mathrm{M}}_{2}$ 管的栅电位保持不变, ${\\mathrm{M}}_{2}$ 管维持最小电流 ${I}_{2\\min }$ 性质不变。而 ${\\mathrm{M}}_{1}$ 管栅电压的继续下降使 ${\\mathrm{M}}_{1}$ 管输出电流继续增加,超出 ${I}_{1\\max }$ 的限制。可见输出晶体管在任何情况下其输出电流都不会等于零,所以该类型输出级的失真特性比电阻前馈型输出级结构有了明显提高。\n设 ${\\mathrm{M}}_{5}$ 、 ${\\mathrm{M}}_{6}$ 两偏置管的跨导为 ${g}_{\\mathrm{m}5}$ 、 ${g}_{\\mathrm{m}6}$ ,输出阻抗为 ${r}_{\\mathrm{{ds}}5}$ 、 ${r}_{\\mathrm{{ds}}6}$ ,而 ${I}_{\\mathrm{Q}}$ 电流源的等效输出电阻为 ${r}_{\\mathrm{{ds}}}$ ,则 $2{I}_{\\mathrm{Q}}$ 电流源的输出阻抗为 ${r}_{\\mathrm{{ds}}}/2$ 。 ${\\mathrm{M}}_{1}$ 和 ${\\mathrm{M}}_{2}$ 管的栅电压差可用于定量描述 Class $\\mathrm{{AB}}$ 的偏置特性,即\n$$\n{V}_{\\mathrm{G}{12}} = {V}_{\\mathrm{G}1} - {V}_{\\mathrm{G}2} = {V}_{\\mathrm{{CC}}} + {V}_{\\mathrm{G}{55}} + {V}_{\\mathrm{G}{56}} - \\left( {{V}_{\\mathrm{G}{53}} + {V}_{\\mathrm{G}{84}}}\\right)  - \\left( {{V}_{\\mathrm{G}{87}} + {V}_{\\mathrm{G}{88}}}\\right)\n$$\n(12 - 60)\n由于 ${I}_{5} + {I}_{6} = 2{I}_{\\mathrm{Q}}$ ,设 ${I}_{5} = {\\alpha 2}{I}_{\\mathrm{Q}}$ ,则 ${I}_{6} = \\left( {1 - \\alpha }\\right) 2{I}_{\\mathrm{Q}}$ ,由此上式化简得\n$$\n{V}_{\\mathrm{G}{12}} = {V}_{\\mathrm{{CC}}} - \\left( {{V}_{\\mathrm{{TN}}} + {V}_{\\mathrm{{TP}}}}\\right)  - \\left( {4 - \\sqrt{2\\alpha } - \\sqrt{2\\left( {1 - \\alpha }\\right) }}\\right) \\sqrt{2{I}_{\\mathrm{Q}}/k} \\tag{12 - 61}\n$$\n静态条件对应于 $\\alpha  = 1/2$ ,当 Class $\\mathrm{{AB}}$ 处在输出负载的动态驱动时,且 $\\alpha$ 在 $0 \\sim  1$ 之间变化,从严格意义上讲, ${V}_{\\mathrm{G}{12}}$ 是无法在整个动态过程中保持恒定的。因此, Class $\\mathrm{{AB}}$ 控制电路的输入阻抗则随控制状态而改变。但当 ${\\mathrm{M}}_{5}$ 管或 ${\\mathrm{M}}_{6}$ 管其中之一截止后,其 $\\alpha  = 0$ 或 $\\alpha  =$ 1,则 ${\\mathrm{V}}_{\\mathrm{G}{12}}$ 保持为固定常数。\n在静态工作点附近, ${\\mathrm{M}}_{5}$ 管的输入阻抗为 $1/{g}_{\\mathrm{m}5}$ ,该阻抗消除了 ${r}_{\\mathrm{{ds6}}}$ 的作用,使 ${\\mathrm{M}}_{6}$ 管的本征电压增益值下降到 ${g}_{\\mathrm{m}6}/{g}_{\\mathrm{m}5}$ 。结合 Cascode 阻抗倍增原理,该类型 Class AB 控制电路的输入阻抗为\n$$\n{r}_{\\mathrm{{in}}} \\approx  \\left( {\\frac{{g}_{\\mathrm{m}6}}{{g}_{\\mathrm{m}5}}\\frac{{r}_{\\mathrm{{ds}}}}{2}}\\right) //\\frac{{r}_{\\mathrm{{ds}}}}{2} \\tag{12 - 62}\n$$\n实际上,由于 ${\\mathrm{M}}_{5}/{\\mathrm{M}}_{6}$ 的并联作用,两管流过的总电流保持 $2{I}_{\\mathrm{Q}}$ 不变,其输出阻抗近似为两个 $2{I}_{\\mathrm{Q}}$ 电流源输出阻抗的并联,因此所增加的控制电路并没有明显降低输出级的输入电阻,从而为输入级和中间级结构的设计奠定了有利条件。\n输入信号因从 ${\\mathrm{M}}_{1}$ 管栅极上输入,则 ${\\mathrm{M}}_{1}$ 管栅极上的前馈小信号增益为 1。根据控制电路的小信号电路结构,可以发现 ${\\mathrm{M}}_{6}$ 与 ${\\mathrm{M}}_{5}$ 两管中变化的小信号电流大小相等,方向相反, 即 ${g}_{\\mathrm{m}5}{V}_{\\mathrm{{in}}} + \\left( {-{g}_{\\mathrm{m}6}{V}_{\\mathrm{g}2}}\\right)  = 0$ ,其中 ${V}_{\\mathrm{g}2}$ 是 ${\\mathrm{M}}_{2}$ 管栅极的前馈小信号电压,则 ${\\mathrm{M}}_{2}$ 管栅极的小信号增益为 ${A}_{\\mathrm{v}} = {V}_{\\mathrm{g}2}/{V}_{\\mathrm{{in}}} = {g}_{\\mathrm{m}5}/{g}_{\\mathrm{m}6}$ 。\n对比电阻偏置型与前馈型结构, 其小信号增益只能小于等于 1 , 而非截止型电路结构中 ${\\mathrm{M}}_{2}$ 管栅极上的小信号增益可以大于 1。在静态工作点下,通常采用对称设计,使该增益接近于单位增益。\n当输出大电流时, ${\\mathrm{M}}_{5}$ 、 ${\\mathrm{M}}_{6}$ 中总有一个晶体管截止,此时 ${\\mathrm{M}}_{1}$ 、 ${\\mathrm{M}}_{2}$ 管中的栅电位差保持固定不变,此时前馈输入电压信号 ${V}_{\\text{in }}$ 直接驱动 ${\\mathrm{M}}_{1}$ 管或经过固定的 ${V}_{\\mathrm{G}{12}}$ 电平移位后驱动 ${\\mathrm{M}}_{2}$ 管并输出大的负载电流。\n非截止前馈控制结构中的静态电流完全由参考电流源 ${I}_{\\mathrm{Q}}$ 决定,不受电源电压 ${V}_{\\mathrm{{CC}}}$ 变化的影响,解决了以上电阻偏置截止型控制电路静态电流随电源电压变化的问题,因此便获得了更广泛的应用。\n理论上将轨至轨互补输入级与 Class AB 的推挽输出级结构有机结合在一起,即可构成各类实用的轨至轨模拟差分 IP 运放电路, 这种电路的核心就是恒定跨导及输入级增益的控制与输出 Class AB 静态工作点的控制。以上两方面的控制都存在前馈与反馈的不同结构。 一般而言,前馈控制结构简单,响应速度高,但精度较差；反馈控制则精度高,但结构复杂,响应速度低, 系统稳定性差。针对动态失真的改善输出管有截止与非截止两种状态控制, 其中非截止型因存在最小非零电流, 不但瞬态响应速度明显改善, 而且动态调节下的系统非线性失真也得到了有效抑制。目前,是能够在亚 $1\\mathrm{\\;V}$ 电压范围内工作的高速、低功耗、宽动态范围下低失真的轨至轨运放电路,它已成为该类型集成模拟运放发展的主要方向。"
}